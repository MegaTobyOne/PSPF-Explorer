<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="PSPF Explorer - Interactive Compliance Framework compliance tracking and management tool">
    <meta name="author" content="PSPF Explorer">
    <meta name="robots" content="noindex, nofollow">
    <title>PSPF Explorer</title>
    <link rel="stylesheet" href="styles/main.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
</head>
<body>
    <!-- Welcome Modal for First-Time Users -->
    <div id="welcomeModal" class="modal">
        <div class="modal-content">
            <h2>Welcome to PSPF Explorer</h2>
            <p>Transform your compliance framework from static documents into an engaging, interactive experience!</p>
            
            <div class="welcome-steps">
                <div class="step">
                    <div class="step-number">1</div>
                    <div class="step-content">
                        <h3>Watch the Heartbeat</h3>
                        <p>Each domain has a heartbeat pulse that shows its health. Unhealthy pulses indicate areas needing attention.</p>
                    </div>
                </div>
                <div class="step">
                    <div class="step-number">2</div>
                    <div class="step-content">
                        <h3>Mark Requirements as Met</h3>
                        <p>Click domains to see requirements. Mark them as "Yes" when complete. Add detailed comments for "No" items to improve the pulse.</p>
                    </div>
                </div>
                <div class="step">
                    <div class="step-number">3</div>
                    <div class="step-content">
                        <h3>Manage Your Work</h3>
                        <p>Add projects, tasks, and track activities. The more you document and complete, the healthier your domains become!</p>
                    </div>
                </div>
            </div>
            
            <div class="pulse-demo">
                <div class="pulse-example healthy">
                    <div class="pulse-dot"></div>
                    <span>Healthy: All requirements met</span>
                </div>
                <div class="pulse-example warning">
                    <div class="pulse-dot"></div>
                    <span>Warning: Some requirements not met with good explanations</span>
                </div>
                <div class="pulse-example critical">
                    <div class="pulse-dot"></div>
                    <span>Critical: Requirements not met with poor or no explanations</span>
                </div>
            </div>
            
            <button id="closeWelcome" class="btn btn-primary">Start Exploring</button>
        </div>
    </div>

    <!-- Header -->
    <header class="header">
        <div class="container">
            <h1 class="logo">PSPF Explorer</h1>
            <nav class="nav">
                <button id="homeBtn" class="nav-btn active">Home</button>
                <button id="searchBtn" class="nav-btn">Search</button>
                <button id="progressBtn" class="nav-btn">Progress</button>
                <button id="dataBtn" class="nav-btn">Data</button>
                <button id="helpBtn" class="nav-btn">Help</button>
            </nav>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main">
        <div class="container">
            <!-- Breadcrumb Navigation -->
            <nav class="breadcrumb" id="breadcrumb">
                <a href="#" data-level="home">PSPF Domains</a>
            </nav>

            <!-- Home View - Domain Overview -->
            <section id="homeView" class="view active">
                <div class="view-header">
                    <h2>Compliance Policy Framework 2025</h2>
                    <p class="subtitle">Watch the heartbeat of your compliance status. Healthy pulses mean strong protection.</p>
                </div>

                <div class="domains-grid" id="domainsGrid">
                    <!-- Domain cards will be dynamically generated -->
                </div>

                <div class="stats-overview" id="statsOverview">
                    <div class="stat-card">
                        <span class="stat-number" id="totalProjects">0</span>
                        <span class="stat-label">Active Projects</span>
                    </div>
                    <div class="stat-card">
                        <span class="stat-number" id="totalTasks">0</span>
                        <span class="stat-label">Total Tasks</span>
                    </div>
                    <div class="stat-card">
                        <span class="stat-number" id="completedTasks">0</span>
                        <span class="stat-label">Completed Tasks</span>
                    </div>
                    <div class="stat-card">
                        <span class="stat-number" id="overallCompliance">0%</span>
                        <span class="stat-label">Requirements Met</span>
                    </div>
                </div>
            </section>

            <!-- Data Management View -->
            <section id="dataView" class="view">
                <div class="view-header">
                    <h2>Data Management</h2>
                    <p class="subtitle">Export, import, and manage your PSPF Explorer data</p>
                </div>
                
                <div class="data-management">
                    <div class="data-section">
                        <div class="data-card">
                            <h3>üóÇÔ∏è Export Data</h3>
                            <p>Download all your projects, tasks, activities, and events as a backup file.</p>
                            <button id="exportDataBtn" class="btn btn-primary">Export All Data</button>
                        </div>
                        
                        <div class="data-card">
                            <h3>üì• Import Data</h3>
                            <p>Restore data from a previously exported backup file.</p>
                            <input type="file" id="importFileInput" accept=".json" class="hidden" title="Select backup file to import">
                            <button id="importDataBtn" class="btn btn-secondary">Import Data</button>
                        </div>
                        
                        <div class="data-card warning">
                            <h3>üóëÔ∏è Clear Data</h3>
                            <p>Remove all data and start fresh. This action cannot be undone.</p>
                            <button id="clearDataBtn" class="btn btn-danger">Clear All Data</button>
                        </div>
                    </div>
                    
                    <div class="data-info">
                        <h3>üìä Data Summary</h3>
                        <div class="data-stats">
                            <div class="stat-item">
                                <span class="stat-label">Projects:</span>
                                <span class="stat-value" id="dataProjectCount">0</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Tasks:</span>
                                <span class="stat-value" id="dataTaskCount">0</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Activities:</span>
                                <span class="stat-value" id="dataRiskCount">0</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Events:</span>
                                <span class="stat-value" id="dataIncidentCount">0</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Last Modified:</span>
                                <span class="stat-value" id="dataLastModified">Never</span>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <script>
    // PSPF Explorer - Minimal Embedded JavaScript Application
    // This is a test version with core functionality embedded to avoid external .js files
    
    class PSPFExplorer {
        constructor() {
            this.projects = JSON.parse(localStorage.getItem('pspf_projects') || '[]');
            this.tasks = JSON.parse(localStorage.getItem('pspf_tasks') || '[]');
            this.currentView = 'home';
            this.init();
        }

        init() {
            this.setupEventListeners();
            this.render();
            this.showWelcomeModalIfFirstTime();
        }

        setupEventListeners() {
            // Navigation buttons
            document.getElementById('homeBtn').addEventListener('click', () => {
                this.navigateTo('home');
                this.updateNavButtons('homeBtn');
            });
            
            document.getElementById('dataBtn').addEventListener('click', () => {
                this.navigateTo('data');
                this.updateNavButtons('dataBtn');
            });
            
            document.getElementById('helpBtn').addEventListener('click', () => {
                this.showWelcomeModal();
            });

            // Welcome modal
            document.getElementById('closeWelcome').addEventListener('click', () => {
                this.hideWelcomeModal();
                localStorage.setItem('pspf_welcome_seen', 'true');
            });

            // Modal close on backdrop click
            document.querySelectorAll('.modal').forEach(modal => {
                modal.addEventListener('click', (e) => {
                    if (e.target === modal) {
                        modal.classList.remove('active');
                    }
                });
            });

            // Data management
            const exportDataBtn = document.getElementById('exportDataBtn');
            if (exportDataBtn) {
                exportDataBtn.addEventListener('click', () => this.exportData());
            }

            const importDataBtn = document.getElementById('importDataBtn');
            const importFileInput = document.getElementById('importFileInput');
            if (importDataBtn && importFileInput) {
                importDataBtn.addEventListener('click', () => importFileInput.click());
                importFileInput.addEventListener('change', (e) => this.importData(e));
            }

            const clearDataBtn = document.getElementById('clearDataBtn');
            if (clearDataBtn) {
                clearDataBtn.addEventListener('click', () => this.clearAllData());
            }
        }

        showWelcomeModalIfFirstTime() {
            const hasSeenWelcome = localStorage.getItem('pspf_welcome_seen');
            if (!hasSeenWelcome) {
                this.showWelcomeModal();
            }
        }

        showWelcomeModal() {
            const modal = document.getElementById('welcomeModal');
            modal.classList.add('active');
        }

        hideWelcomeModal() {
            const modal = document.getElementById('welcomeModal');
            modal.classList.remove('active');
        }

        navigateTo(view) {
            this.currentView = view;
            this.render();
        }

        updateNavButtons(activeId) {
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.getElementById(activeId).classList.add('active');
        }

        render() {
            // Hide all views
            document.querySelectorAll('.view').forEach(view => {
                view.classList.remove('active');
            });
            
            // Show current view
            const currentViewEl = document.getElementById(`${this.currentView}View`);
            if (currentViewEl) {
                currentViewEl.classList.add('active');
            }
            
            // Render specific view content
            switch (this.currentView) {
                case 'home':
                    this.renderHome();
                    break;
                case 'data':
                    this.renderDataManagement();
                    break;
            }
        }

        renderHome() {
            this.renderStatsOverview();
            // Simplified domain rendering for test
            const grid = document.getElementById('domainsGrid');
            grid.innerHTML = '<div class="domain-card"><h3>Test Domain</h3><p>This is a minimal test version</p></div>';
        }

        renderStatsOverview() {
            const totalProjects = this.projects.length;
            const totalTasks = this.tasks.length;
            const completedTasks = this.tasks.filter(t => t.status === 'completed').length;
            
            document.getElementById('totalProjects').textContent = totalProjects;
            document.getElementById('totalTasks').textContent = totalTasks;
            document.getElementById('completedTasks').textContent = completedTasks;
            document.getElementById('overallCompliance').textContent = '0%';
        }

        renderDataManagement() {
            this.updateDataStats();
        }

        updateDataStats() {
            document.getElementById('dataProjectCount').textContent = this.projects.length;
            document.getElementById('dataTaskCount').textContent = this.tasks.length;
            document.getElementById('dataRiskCount').textContent = '0';
            document.getElementById('dataIncidentCount').textContent = '0';
            
            const lastModified = localStorage.getItem('pspf_last_modified');
            if (lastModified) {
                const date = new Date(lastModified);
                document.getElementById('dataLastModified').textContent = date.toLocaleString();
            } else {
                document.getElementById('dataLastModified').textContent = 'Never';
            }
        }

        exportData() {
            try {
                const exportData = {
                    version: '1.0',
                    exportDate: new Date().toISOString(),
                    data: {
                        projects: this.projects,
                        tasks: this.tasks
                    }
                };

                const dataStr = JSON.stringify(exportData, null, 2);
                const dataBlob = new Blob([dataStr], { type: 'application/json' });
                
                const downloadLink = document.createElement('a');
                downloadLink.href = URL.createObjectURL(dataBlob);
                downloadLink.download = `pspf-explorer-backup-${new Date().toISOString().slice(0, 19).replace(/[:.]/g, '-')}.json`;
                
                document.body.appendChild(downloadLink);
                downloadLink.click();
                document.body.removeChild(downloadLink);
                
                alert('Data exported successfully!');
                
            } catch (error) {
                console.error('Export failed:', error);
                alert('Export failed. Please try again.');
            }
        }

        importData(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = (e) => {
                try {
                    const importData = JSON.parse(e.target.result);
                    
                    if (!importData.data || !importData.version) {
                        throw new Error('Invalid backup file format');
                    }

                    if (!confirm('This will replace all current data with imported data. Continue?')) {
                        return;
                    }

                    this.projects = importData.data.projects || [];
                    this.tasks = importData.data.tasks || [];

                    this.saveData();
                    this.updateDataStats();
                    this.renderHome();

                    alert('Data imported successfully!');
                    
                } catch (error) {
                    console.error('Import failed:', error);
                    alert('Import failed. Please check the file format and try again.');
                }
            };

            reader.readAsText(file);
            event.target.value = '';
        }

        clearAllData() {
            if (!confirm('This will permanently delete ALL your data. This action cannot be undone!\n\nAre you sure?')) {
                return;
            }

            try {
                this.projects = [];
                this.tasks = [];

                localStorage.removeItem('pspf_projects');
                localStorage.removeItem('pspf_tasks');
                localStorage.removeItem('pspf_last_modified');

                this.updateDataStats();
                this.renderHome();

                alert('All data has been cleared successfully.');
                
            } catch (error) {
                console.error('Clear data failed:', error);
                alert('Failed to clear data. Please try again.');
            }
        }

        saveData() {
            localStorage.setItem('pspf_projects', JSON.stringify(this.projects));
            localStorage.setItem('pspf_tasks', JSON.stringify(this.tasks));
            localStorage.setItem('pspf_last_modified', new Date().toISOString());
        }
    }

    // Initialize application when DOM is loaded
    document.addEventListener('DOMContentLoaded', () => {
        window.pspfExplorer = new PSPFExplorer();
    });
    </script>
</body>
</html>
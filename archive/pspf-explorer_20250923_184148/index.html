<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="PSPF Explorer 2025 - Interactive Australian Government Protective Security Policy Framework compliance tracking and management tool">
    <meta name="author" content="PSPF Explorer">
    <meta name="robots" content="noindex, nofollow">
    <title>PSPF Explorer 2025</title>
    <link rel="stylesheet" href="styles/main.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* Modern Dark Theme Design System Variables */
        :root {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --primary-color: #667eea;
            --primary-dark: #5a67d8;
            --secondary-color: #764ba2;
            --accent-color: #8b5cf6;
            --success-color: #10b981;
            --warning-color: #f59e0b;
            --danger-color: #ef4444;
            --danger-light: #fef2f2;
            --info-color: #3b82f6;
            
            --bg-primary: #1e293b;
            --bg-secondary: #0f172a;
            --bg-tertiary: #334155;
            --bg-card: #1e293b;
            --bg-elevated: #2d3748;
            --bg-light: #f8fafc;
            --bg-hover: #f1f5f9;
            
            --text-primary: #f1f5f9;
            --text-secondary: #cbd5e1;
            --text-muted: #64748b;
            
            --border-light: #334155;
            --border-medium: #475569;
            --border-dark: #64748b;
            --border-color: #e5e7eb;
            
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.3);
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.4), 0 2px 4px -2px rgb(0 0 0 / 0.4);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.5), 0 4px 6px -4px rgb(0 0 0 / 0.5);
            --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.6), 0 8px 10px -6px rgb(0 0 0 / 0.6);
            
            --radius-sm: 0.375rem;
            --radius-md: 0.5rem;
            --radius-lg: 0.75rem;
            --radius-xl: 1rem;

            /* Dark chip color helpers */
            --chip-bg-success: rgba(16, 185, 129, 0.15);
            --chip-br-success: rgba(16, 185, 129, 0.35);
            --chip-bg-info: rgba(59, 130, 246, 0.15);
            --chip-br-info: rgba(59, 130, 246, 0.35);
            --chip-bg-warning: rgba(245, 158, 11, 0.15);
            --chip-br-warning: rgba(245, 158, 11, 0.35);
            --chip-bg-danger: rgba(239, 68, 68, 0.15);
            --chip-br-danger: rgba(239, 68, 68, 0.35);
            --chip-bg-orange: rgba(249, 115, 22, 0.15);
            --chip-br-orange: rgba(249, 115, 22, 0.35);
        }

        /* Global Styles */
        * {
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: var(--text-primary);
            background: var(--bg-secondary);
            padding: 0;
        }

        /* Header Enhancement */
        .header {
            background: var(--primary-gradient);
            box-shadow: var(--shadow-lg);
            border-bottom: none;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 4rem;
        }

        .logo {
            color: white;
            font-size: 1.5rem;
            font-weight: 700;
            margin: 0;
            text-shadow: 0 1px 2px rgba(0,0,0,0.1);
        }

        .logo::before {
            content: "üõ°Ô∏è ";
            margin-right: 0.5rem;
        }

        .nav {
            display: flex;
            gap: 0.5rem;
        }

        .nav-btn {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.2);
            padding: 0.5rem 1rem;
            border-radius: var(--radius-md);
            font-weight: 500;
            transition: all 0.2s ease;
            -webkit-backdrop-filter: blur(10px);
            backdrop-filter: blur(10px);
        }

        .nav-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-1px);
            box-shadow: var(--shadow-md);
        }

        .nav-btn.active {
            background: white;
            color: var(--primary-color);
            box-shadow: var(--shadow-md);
        }

        /* Main Container */
        .main {
            min-height: calc(100vh - 4rem);
            padding: 2rem 0;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1.5rem;
        }

        /* Enhanced Breadcrumb */
        .breadcrumb {
            display: none;
            background: var(--bg-card);
            padding: 0.75rem 1.25rem;
            border-radius: var(--radius-lg);
            margin-bottom: 1.5rem;
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border-light);
        }

        .breadcrumb a {
            color: var(--primary-color);
            text-decoration: none;
            font-weight: 500;
            transition: color 0.2s ease;
        }

        .breadcrumb a:hover {
            color: var(--primary-dark);
        }

        .breadcrumb .current {
            color: var(--text-secondary);
            font-weight: 600;
        }

        /* View Headers */
        .view-header {
            text-align: center;
            margin-bottom: 3rem;
        }

        .view-header h2 {
            font-size: 2.5rem;
            font-weight: 700;
            margin: 0 0 0.5rem 0;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .view, .tab-pane {
            animation: fadeIn 0.5s ease-in-out;
        }

        /* View visibility and utility helpers */
        .view { display: none; }
        .view.active { display: block; }
        .hidden { display: none !important; }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .subtitle {
            font-size: 1.125rem;
            color: var(--text-secondary);
            margin: 0;
            font-weight: 400;
            line-height: 1.6;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
        }

        /* Requirements Section */
        .requirements-layout {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 2rem;
            margin-top: 1.5rem;
            align-items: start;
        }

        .requirements-list {
            background: var(--bg-card);
            border-radius: var(--radius-lg);
            padding: 1.5rem;
            border: 1px solid var(--border-light);
            height: 70vh;
            max-height: 70vh;
            display: flex;
            flex-direction: column;
        }

        .requirements-list h4 {
            margin: 0 0 1rem 0;
            color: var(--text-primary);
            font-size: 1.1rem;
            font-weight: 600;
            flex-shrink: 0;
        }

        .requirements-sidebar {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            overflow-y: auto;
            padding-right: 0.5rem;
            flex: 1;
        }

        /* Custom scrollbar for requirements list */
        .requirements-sidebar::-webkit-scrollbar {
            width: 6px;
        }

        .requirements-sidebar::-webkit-scrollbar-track {
            background: var(--bg-secondary);
            border-radius: 3px;
        }

        .requirements-sidebar::-webkit-scrollbar-thumb {
            background: var(--border-light);
            border-radius: 3px;
        }

        .requirements-sidebar::-webkit-scrollbar-thumb:hover {
            background: var(--text-secondary);
        }

        .requirement-details {
            position: sticky;
            top: 2rem;
            height: 70vh;
            max-height: 70vh;
            background: var(--bg-card);
            border-radius: var(--radius-lg);
            border: 1px solid var(--border-light);
            display: flex;
            flex-direction: column;
        }

        .requirement-detail-content {
            padding: 1.5rem;
            overflow-y: auto;
            flex: 1;
        }

        /* Custom scrollbar for details pane */
        .requirement-detail-content::-webkit-scrollbar {
            width: 6px;
        }

        .requirement-detail-content::-webkit-scrollbar-track {
            background: var(--bg-secondary);
            border-radius: 3px;
        }

        .requirement-detail-content::-webkit-scrollbar-thumb {
            background: var(--border-light);
            border-radius: 3px;
        }

        .requirement-detail-content::-webkit-scrollbar-thumb:hover {
            background: var(--text-secondary);
        }

        .requirement-item {
            background: var(--bg-tertiary);
            border: 1px solid var(--border-light);
            border-radius: var(--radius-md);
            padding: 0.75rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .requirement-item:hover {
            background: var(--bg-elevated);
            border-color: var(--border-medium);
            transform: translateY(-1px);
        }

        .requirement-item.active {
            background: var(--primary-color);
            border-color: var(--primary-color);
            color: white;
        }

        .requirement-item.active .requirement-status {
            color: rgba(255, 255, 255, 0.9);
        }

        .requirement-code {
            font-weight: 600;
            font-size: 0.9rem;
        }

        .requirement-info {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .url-indicator {
            font-size: 0.75rem;
            padding: 0.125rem 0.25rem;
            background: var(--primary-light);
            color: var(--primary-dark);
            border-radius: var(--radius-sm);
            cursor: help;
            opacity: 0.8;
        }

        .requirement-status {
            font-size: 0.8rem;
            padding: 0.25rem 0.5rem;
            border-radius: var(--radius-sm);
            font-weight: 500;
        }

        .requirement-status.yes {
            background: var(--chip-bg-success);
            color: var(--success-color);
            border: 1px solid var(--chip-br-success);
        }

        .requirement-status.no {
            background: var(--chip-bg-danger);
            color: var(--danger-color);
            border: 1px solid var(--chip-br-danger);
        }

        .requirement-status.partial {
            background: var(--chip-bg-warning);
            color: var(--warning-color);
            border: 1px solid var(--chip-br-warning);
        }

        .requirement-status.not-set {
            background: var(--bg-tertiary);
            color: var(--text-muted);
            border: 1px solid var(--border-light);
        }

        .requirement-details {
            background: var(--bg-card);
            border-radius: var(--radius-lg);
            padding: 2rem;
            border: 1px solid var(--border-light);
            min-height: 400px;
        }

        .requirement-detail-content h4 {
            margin: 0 0 1rem 0;
            color: var(--text-primary);
            font-size: 1.2rem;
            font-weight: 600;
        }

        .requirement-detail-content p {
            color: var(--text-secondary);
            line-height: 1.6;
            margin-bottom: 1.5rem;
        }

        /* Linked Projects Section */
        .linked-projects-section {
            background: var(--bg-card);
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border: 1px solid var(--border-light);
        }

        .linked-projects-section h5 {
            margin: 0 0 1rem 0;
            color: var(--primary-color);
            font-weight: 600;
        }

        .linked-projects-list {
            margin-bottom: 1rem;
        }

        .linked-project-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0.75rem;
            background: var(--bg-elevated);
            border: 1px solid var(--border-light);
            border-radius: 6px;
            margin-bottom: 0.5rem;
            transition: all 0.2s ease;
        }

        .linked-project-item:hover {
            background: var(--bg-tertiary);
            border-color: var(--primary-color);
        }

        .project-name {
            font-weight: 500;
            color: var(--text-primary);
            flex: 1;
        }

        .project-status {
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-size: 0.85rem;
            font-weight: 500;
            margin: 0 0.5rem;
        }

        .no-projects {
            color: var(--text-secondary);
            font-style: italic;
            margin: 0;
            padding: 1rem;
            text-align: center;
            background: var(--bg-secondary);
            border-radius: 4px;
            border: 1px solid var(--border-light);
        }

        .btn-small {
            padding: 0.375rem 0.75rem;
            font-size: 0.875rem;
        }

        .btn-link {
            background: none;
            border: 1px solid var(--border-light);
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.2s ease;
            border-radius: 4px;
        }

        .btn-link:hover {
            background: var(--danger-color);
            border-color: var(--danger-color);
            color: white;
        }

        .compliance-controls {
            margin-top: 2rem;
            padding-top: 1.5rem;
            border-top: 1px solid var(--border-light);
        }

        .compliance-controls h5 {
            margin: 0 0 1rem 0;
            color: var(--text-primary);
            font-size: 1rem;
            font-weight: 600;
        }

        .compliance-select {
            background: var(--bg-tertiary);
            border: 1px solid var(--border-light);
            border-radius: var(--radius-md);
            padding: 0.75rem;
            color: var(--text-primary);
            font-size: 0.9rem;
            width: 100%;
            margin-bottom: 1rem;
        }

        .compliance-comment {
            background: var(--bg-tertiary);
            border: 1px solid var(--border-light);
            border-radius: var(--radius-md);
            padding: 0.75rem;
            color: var(--text-primary);
            font-size: 0.9rem;
            width: 100%;
            min-height: 100px;
            resize: vertical;
            font-family: inherit;
        }

        .compliance-url {
            background: var(--bg-tertiary);
            border: 1px solid var(--border-light);
            border-radius: var(--radius-md);
            padding: 0.75rem;
            color: var(--text-primary);
            font-size: 0.9rem;
            width: 100%;
            margin-bottom: 0.25rem;
            font-family: inherit;
        }

        .field-help {
            display: block;
            margin-bottom: 1rem;
            font-size: 0.75rem;
            color: var(--text-secondary);
            font-style: italic;
        }

        .requirement-url-section {
            margin: 1rem 0;
            padding: 1rem;
            background: var(--bg-secondary);
            border-radius: var(--radius-md);
            border: 1px solid var(--border-light);
        }

        .requirement-url-section h5 {
            margin: 0 0 0.5rem 0;
            color: var(--text-primary);
            font-size: 0.875rem;
            font-weight: 600;
        }

        .url-display {
            margin: 0;
        }

        .requirement-link {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--primary-color);
            text-decoration: none;
            font-size: 0.875rem;
            word-break: break-all;
            line-height: 1.4;
            transition: color 0.2s ease;
        }

        .requirement-link:hover {
            color: var(--primary-dark);
            text-decoration: underline;
        }

        .external-icon {
            font-size: 0.75rem;
            opacity: 0.7;
            flex-shrink: 0;
        }

        .placeholder-content {
            text-align: center;
            color: var(--text-muted);
            padding: 3rem 1rem;
        }

        .placeholder-content h4 {
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
        }

        /* Responsive layout for requirements */
        @media (max-width: 1024px) {
            .requirements-layout {
                grid-template-columns: 1fr;
                gap: 1.5rem;
            }
            
            .requirements-list {
                order: 2;
                height: 50vh;
                max-height: 50vh;
            }
            
            .requirement-details {
                order: 1;
                position: static;
                height: 60vh;
                max-height: 60vh;
            }
        }

        /* Projects Layout - similar to requirements */
        .projects-layout {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 2rem;
            margin-top: 1.5rem;
        }

        .projects-list-panel {
            background: var(--bg-card);
            border-radius: var(--radius-lg);
            padding: 1.5rem;
            border: 1px solid var(--border-light);
            height: fit-content;
        }

        .projects-list-panel h4 {
            margin: 0 0 1rem 0;
            color: var(--text-primary);
            font-size: 1.1rem;
            font-weight: 600;
        }

        .projects-sidebar {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .project-item {
            background: var(--bg-tertiary);
            border: 1px solid var(--border-light);
            border-radius: var(--radius-md);
            padding: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .project-item:hover {
            background: var(--bg-elevated);
            border-color: var(--border-medium);
            transform: translateY(-1px);
        }

        .project-item.active {
            background: var(--primary-color);
            border-color: var(--primary-color);
            color: white;
        }

        .project-item.active .project-meta {
            color: rgba(255, 255, 255, 0.9);
        }

        .project-name {
            font-weight: 600;
            font-size: 1rem;
        }

        .project-meta {
            font-size: 0.9rem;
            color: var(--text-secondary);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .project-status {
            font-size: 0.8rem;
            padding: 0.25rem 0.5rem;
            border-radius: var(--radius-sm);
            font-weight: 500;
        }

        .project-status.planning {
            background: var(--chip-bg-info);
            color: var(--info-color);
            border: 1px solid var(--chip-br-info);
        }

        .project-status.active {
            background: var(--chip-bg-success);
            color: var(--success-color);
            border: 1px solid var(--chip-br-success);
        }

        .project-status.on-hold {
            background: var(--chip-bg-warning);
            color: var(--warning-color);
            border: 1px solid var(--chip-br-warning);
        }

        .project-status.completed {
            background: var(--chip-bg-success);
            color: var(--success-color);
            border: 1px solid var(--chip-br-success);
        }

        .project-details-panel {
            background: var(--bg-card);
            border-radius: var(--radius-lg);
            padding: 2rem;
            border: 1px solid var(--border-light);
            min-height: 500px;
        }

        .project-detail-content h4 {
            margin: 0 0 1rem 0;
            color: var(--text-primary);
            font-size: 1.3rem;
            font-weight: 600;
        }

        .project-detail-content p {
            color: var(--text-secondary);
            line-height: 1.6;
            margin-bottom: 1.5rem;
        }

        .project-actions {
            margin-top: 2rem;
            padding-top: 1.5rem;
            border-top: 1px solid var(--border-light);
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .project-detail-meta {
            background: var(--bg-tertiary);
            border-radius: var(--radius-md);
            padding: 1rem;
            margin: 1.5rem 0;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
        }

        .project-detail-meta-item {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }

        .project-detail-meta-label {
            font-size: 0.8rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .project-detail-meta-value {
            font-weight: 600;
            color: var(--text-primary);
        }

        /* Responsive layout for projects */
        @media (max-width: 1024px) {
            .projects-layout {
                grid-template-columns: 1fr;
                gap: 1.5rem;
            }
            
            .projects-list-panel {
                order: 2;
            }
            
            .project-details-panel {
                order: 1;
            }
        }
        .domains-grid {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 1rem;
            margin-bottom: 3rem;
        }

        .domain-card {
            background: var(--bg-card);
            border-radius: var(--radius-xl);
            padding: 1rem;
            border: 1px solid var(--border-light);
            box-shadow: var(--shadow-sm);
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
            text-align: center;
        }

        .domain-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--primary-gradient);
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }

        .domain-header {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 0.5rem;
        }

        .pulse-indicator {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-top: 1rem;
            padding-top: 0.75rem;
        }

        .domain-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-xl);
        }

        .domain-card:hover::before {
            transform: scaleX(1);
        }

        .domain-card h3 {
            margin: 0;
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text-primary);
            text-align: center;
        }

        .domain-card p {
            color: var(--text-secondary);
            margin: 0 0 1rem 0;
            line-height: 1.5;
        }

        /* Enhanced Pulse Animation */
        .pulse-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            display: inline-block;
            position: relative;
            flex-shrink: 0;
        }

        .pulse-dot::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        .pulse-dot.healthy {
            background: var(--success-color);
        }

        .pulse-dot.healthy::before {
            background: var(--success-color);
        }

        .pulse-dot.warning {
            background: var(--warning-color);
        }

        .pulse-dot.warning::before {
            background: var(--warning-color);
        }

        .pulse-dot.critical {
            background: var(--danger-color);
        }

        .pulse-dot.critical::before {
            background: var(--danger-color);
        }

        .domain-stats {
            margin-bottom: 1rem;
        }

        .health-text {
            color: var(--text-secondary);
            font-size: 0.875rem;
        }

        @keyframes pulse {
            0% {
                transform: scale(1);
                opacity: 1;
            }
            50% {
                transform: scale(1.5);
                opacity: 0.7;
            }
            100% {
                transform: scale(2);
                opacity: 0;
            }
        }

        /* Welcome Dashboard */
        .welcome-dashboard {
            margin-top: 3rem;
            margin-bottom: 2rem;
        }

        .dashboard-header {
            text-align: center;
            margin-bottom: 2rem;
        }

        .dashboard-header h3 {
            margin: 0 0 0.5rem 0;
            color: var(--text-primary);
            font-size: 1.5rem;
            font-weight: 600;
        }

        .dashboard-subtitle {
            color: var(--text-secondary);
            margin: 0;
            font-size: 1rem;
        }

        .dashboard-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: var(--bg-card);
            border-radius: var(--radius-lg);
            padding: 1.5rem;
            text-align: center;
            border: 1px solid var(--border-light);
            box-shadow: var(--shadow-sm);
        }

        .stat-number {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 0.5rem;
        }

        .stat-label {
            color: var(--text-secondary);
            font-size: 0.875rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .dashboard-content {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .domain-summary h4,
        .quick-actions h4 {
            margin: 0 0 1rem 0;
            color: var(--text-primary);
            font-size: 1.25rem;
            font-weight: 600;
        }

        .domain-summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1rem;
        }

        .domain-summary-card {
            background: var(--bg-card);
            border-radius: var(--radius-md);
            padding: 1rem;
            border: 1px solid var(--border-light);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .domain-summary-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .domain-summary-title {
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.25rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .domain-summary-count {
            color: var(--text-secondary);
            font-size: 0.875rem;
            margin-bottom: 0.5rem;
        }

        .domain-summary-desc {
            color: var(--text-secondary);
            font-size: 0.8rem;
            line-height: 1.4;
        }

        .action-cards {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .action-card {
            background: var(--bg-card);
            border-radius: var(--radius-md);
            padding: 1.25rem;
            border: 1px solid var(--border-light);
            box-shadow: var(--shadow-sm);
        }

        .action-card h5 {
            margin: 0 0 0.5rem 0;
            color: var(--text-primary);
            font-size: 1rem;
            font-weight: 600;
        }

        .action-card p {
            margin: 0 0 1rem 0;
            color: var(--text-secondary);
            font-size: 0.875rem;
            line-height: 1.4;
        }

        .pspf-highlights {
            background: var(--bg-card);
            border-radius: var(--radius-lg);
            padding: 1.5rem;
            border: 1px solid var(--border-light);
        }

        .pspf-highlights h4 {
            margin: 0 0 1rem 0;
            color: var(--text-primary);
            font-size: 1.25rem;
            font-weight: 600;
        }

        .highlights-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
        }

        .highlight-item {
            display: flex;
            gap: 1rem;
            align-items: flex-start;
        }

        .highlight-icon {
            font-size: 1.5rem;
            flex-shrink: 0;
        }

        .highlight-content h6 {
            margin: 0 0 0.25rem 0;
            color: var(--text-primary);
            font-size: 0.95rem;
            font-weight: 600;
        }

        .highlight-content p {
            margin: 0;
            color: var(--text-secondary);
            font-size: 0.85rem;
            line-height: 1.4;
        }

        @media (max-width: 1024px) {
            .dashboard-content {
                grid-template-columns: 1fr;
                gap: 1.5rem;
            }

            .dashboard-stats {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 768px) {
            .dashboard-stats {
                grid-template-columns: 1fr;
            }

            .highlights-grid {
                grid-template-columns: 1fr;
            }
        }
        .stats-overview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin-top: 3rem;
        }

        .stat-card {
            background: var(--bg-card);
            padding: 1.5rem;
            border-radius: var(--radius-xl);
            box-shadow: var(--shadow-md);
            border: 1px solid var(--border-light);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            min-height: 180px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--primary-gradient);
        }

        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .stat-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }
        
        .stat-icon {
            font-size: 2rem;
            opacity: 0.8;
        }

        .stat-number {
            display: block;
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 0.5rem;
            animation: countUp 1s ease-out;
        }
        
        @keyframes countUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .stat-label {
            color: var(--text-secondary);
            font-weight: 500;
            text-transform: uppercase;
            font-size: 0.875rem;
            letter-spacing: 0.05em;
        }

        .progress-ring {
            position: relative;
            width: 60px;
            height: 60px;
        }
        
        .progress-ring svg {
            transform: rotate(-90deg);
            width: 100%;
            height: 100%;
        }
        
        .progress-ring-background {
            fill: none;
            stroke: var(--border-light);
            stroke-width: 4;
        }
        
        .progress-ring-progress {
            fill: none;
            stroke: var(--primary-color);
            stroke-width: 4;
            stroke-linecap: round;
            transition: stroke-dashoffset 1.5s ease-in-out;
        }
        
        .progress-ring-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .stat-trend {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-top: 0.5rem;
            font-size: 0.8rem;
            font-weight: 500;
        }
        
        .trend-up {
            color: var(--success-color);
        }
        
        .trend-down {
            color: var(--danger-color);
        }
        
        .trend-neutral {
            color: var(--text-secondary);
        }
        
        .mini-chart {
            height: 30px;
            margin: 0.5rem 0;
            position: relative;
            background: var(--bg-elevated);
            border-radius: var(--radius-sm);
            overflow: hidden;
        }
        
        .mini-chart-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-color), var(--accent-color));
            border-radius: var(--radius-sm);
            transition: width 1.5s ease-in-out;
            position: relative;
            width: 0%;
        }
        
        .mini-chart-bar.risk-chart {
            background: linear-gradient(90deg, var(--warning-color), var(--danger-color));
        }
        
        .mini-chart-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2));
            animation: shimmer 2s infinite;
        }
        
        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        /* Enhanced Buttons */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 0.625rem 1.25rem;
            border-radius: var(--radius-md);
            font-weight: 500;
            text-decoration: none;
            border: none;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.875rem;
            line-height: 1.25rem;
        }

        .btn-primary {
            background: var(--primary-gradient);
            color: white;
            box-shadow: var(--shadow-sm);
        }

        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: var(--shadow-md);
        }

        .btn-secondary {
            background: var(--bg-elevated);
            color: var(--text-primary);
            border: 1px solid var(--border-medium);
        }

        .btn-secondary:hover {
            background: var(--bg-tertiary);
            border-color: var(--border-dark);
        }

        .btn-danger {
            background: var(--danger-color);
            color: white;
        }

        .btn-danger:hover {
            background: #dc2626;
            transform: translateY(-1px);
        }

        .btn-success {
            background: var(--success-color);
            color: white;
        }

        .btn-success:hover {
            background: #059669;
            transform: translateY(-1px);
        }

        .btn-outline {
            background: transparent;
            color: var(--primary-color);
            border: 1px solid var(--primary-color);
        }

        .btn-outline:hover {
            background: var(--primary-color);
            color: white;
        }

        .btn-small {
            padding: 0.375rem 0.75rem;
            font-size: 0.8rem;
        }

        /* Enhanced Modals */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            -webkit-backdrop-filter: blur(4px);
            backdrop-filter: blur(4px);
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .modal[style*="block"] {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background: var(--bg-card);
            border-radius: var(--radius-xl);
            box-shadow: var(--shadow-xl);
            max-width: 500px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            animation: modalSlideIn 0.3s ease;
        }

        @keyframes modalSlideIn {
            from {
                transform: translate(-50%, -60%);
                opacity: 0;
            }
            to {
                transform: translate(-50%, -50%);
                opacity: 1;
            }
        }

        .modal-content h3 {
            margin: 0 0 1.5rem 0;
            padding: 1.5rem 1.5rem 0 1.5rem;
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        /* Requirements checklist */
        .requirements-checklist {
            max-height: 280px;
            overflow: auto;
            border: 1px solid var(--border-light);
            border-radius: 8px;
            padding: 8px;
            margin: 0 1.5rem 1rem 1.5rem;
            background: var(--bg-elevated);
        }

        /* Welcome modal list */
        .welcome-list {
            text-align: left;
            color: var(--text-secondary);
            margin: 1rem 0;
            list-style: none;
            padding-left: 0;
        }

        .form-group {
            margin-bottom: 1.25rem;
            padding: 0 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: var(--text-primary);
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid var(--border-medium);
            border-radius: var(--radius-md);
            font-size: 0.875rem;
            transition: all 0.2s ease;
            background: var(--bg-elevated);
            color: var(--text-primary);
        }

        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .btn:focus-visible, .nav-btn:focus-visible, .tab-btn:focus-visible {
            outline: 2px solid var(--primary-color);
            outline-offset: 2px;
            box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.2);
        }

        .form-actions {
            display: flex;
            gap: 0.75rem;
            justify-content: flex-end;
            padding: 1.5rem;
            border-top: 1px solid var(--border-light);
            background: var(--bg-elevated);
            border-radius: 0 0 var(--radius-xl) var(--radius-xl);
        }

        /* Task Management Styles */
        .task-card {
            background: var(--bg-card);
            border: 1px solid var(--border-light);
            border-radius: var(--radius-lg);
            padding: 1.25rem;
            margin-bottom: 1rem;
            transition: all 0.3s ease;
            box-shadow: var(--shadow-sm);
        }
        
        .task-card:hover {
            box-shadow: var(--shadow-md);
            transform: translateY(-1px);
        }
        
        .task-card.completed {
            background: rgba(16, 185, 129, 0.1);
            border-color: var(--success-color);
        }
        
        .task-card.in-progress {
            border-left: 4px solid var(--info-color);
        }
        
        .task-card.blocked {
            border-left: 4px solid var(--danger-color);
        }
        
        .task-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 0.75rem;
        }
        
        .task-header h4 {
            margin: 0;
            color: var(--text-primary);
            font-size: 1.125rem;
            font-weight: 600;
        }
        
        .task-description {
            color: var(--text-secondary);
            margin: 0.75rem 0;
            line-height: 1.5;
        }
        
        .task-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 0.75rem;
            margin: 1rem 0;
            font-size: 0.875rem;
        }
        
        .task-meta .assignee {
            background: var(--bg-elevated);
            color: var(--text-primary);
            padding: 0.25rem 0.75rem;
            border-radius: var(--radius-md);
            font-weight: 500;
        }
        
        .task-meta .due-date {
            background: #fef3c7;
            color: #92400e;
            padding: 0.25rem 0.75rem;
            border-radius: var(--radius-md);
            font-weight: 500;
        }
        
        .task-meta .due-date.overdue {
            background: #fee2e2;
            color: #991b1b;
        }
        
        .task-meta .overdue-indicator {
            background: var(--danger-color);
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: var(--radius-md);
            font-size: 0.8rem;
            font-weight: 600;
        }
        
        .task-actions {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
        }
        
        .status-badge {
            padding: 0.25rem 0.75rem;
            border-radius: var(--radius-md);
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: capitalize;
        }
        
        .status-badge.not-started {
            background: var(--bg-tertiary);
            color: var(--text-secondary);
        }
        
        .status-badge.in-progress {
            background: var(--chip-bg-info);
            color: var(--info-color);
            border: 1px solid var(--chip-br-info);
        }
        
        .status-badge.completed {
            background: var(--chip-bg-success);
            color: var(--success-color);
            border: 1px solid var(--chip-br-success);
        }
        
        .status-badge.blocked {
            background: var(--chip-bg-danger);
            color: var(--danger-color);
            border: 1px solid var(--chip-br-danger);
        }

        /* Project status variants */
        .status-badge.planning {
            background: var(--chip-bg-info);
            color: var(--info-color);
            border: 1px solid var(--chip-br-info);
        }
        .status-badge.active {
            background: var(--chip-bg-success);
            color: var(--success-color);
            border: 1px solid var(--chip-br-success);
        }
        .status-badge.on-hold {
            background: var(--chip-bg-warning);
            color: var(--warning-color);
            border: 1px solid var(--chip-br-warning);
        }
        
        .empty-state {
            text-align: center;
            padding: 3rem 1.5rem;
            color: var(--text-secondary);
            background: var(--bg-card);
            border-radius: var(--radius-lg);
            border: 2px dashed var(--border-medium);
        }
        
        .empty-state h3 {
            margin-bottom: 0.5rem;
            color: var(--text-primary);
            font-weight: 600;
        }

        /* Enhanced Risk Management Styles */
        .risk-card {
            background: var(--bg-card);
            border: 1px solid var(--border-light);
            border-radius: var(--radius-lg);
            padding: 1.25rem;
            margin-bottom: 1rem;
            transition: all 0.3s ease;
            box-shadow: var(--shadow-sm);
            position: relative;
            overflow: hidden;
        }
        
        .risk-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            bottom: 0;
            width: 4px;
        }
        
        .risk-card:hover {
            box-shadow: var(--shadow-lg);
            transform: translateY(-2px);
        }
        
        .risk-card.severity-low::before {
            background: var(--success-color);
        }
        
        .risk-card.severity-medium::before {
            background: var(--warning-color);
        }
        
        .risk-card.severity-high::before {
            background: #f97316;
        }
        
        .risk-card.severity-critical::before {
            background: var(--danger-color);
        }
        
        .risk-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 0.75rem;
        }
        
        .risk-header h4 {
            margin: 0;
            color: var(--text-primary);
            font-size: 1.125rem;
            font-weight: 600;
        }
        
        .risk-severity {
            margin-left: 1rem;
        }
        
        .severity-badge {
            padding: 0.375rem 0.75rem;
            border-radius: var(--radius-md);
            font-size: 0.8rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.025em;
            display: inline-flex;
            align-items: center;
            gap: 0.25rem;
        }
        
        .severity-badge.low {
            background: var(--chip-bg-success);
            color: var(--success-color);
            border: 1px solid var(--chip-br-success);
        }
        
        .severity-badge.medium {
            background: var(--chip-bg-warning);
            color: var(--warning-color);
            border: 1px solid var(--chip-br-warning);
        }
        
        .severity-badge.high {
            background: var(--chip-bg-orange);
            color: #f97316;
            border: 1px solid var(--chip-br-orange);
        }
        
        .severity-badge.critical {
            background: var(--chip-bg-danger);
            color: var(--danger-color);
            border: 1px solid var(--chip-br-danger);
            animation: criticalPulse 2s infinite;
        }
        
        @keyframes criticalPulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
        }
        
        .risk-description {
            color: var(--text-secondary);
            margin: 0.75rem 0;
            line-height: 1.5;
        }
        
        .risk-matrix {
            display: flex;
            gap: 1.5rem;
            margin: 1rem 0;
            padding: 1rem;
            background: var(--bg-elevated);
            border-radius: var(--radius-md);
            border: 1px solid var(--border-light);
        }
        
        .risk-factor {
            display: flex;
            flex-direction: column;
            gap: 0.375rem;
            flex: 1;
        }
        
        .factor-label {
            font-size: 0.875rem;
            color: var(--text-secondary);
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.025em;
        }
        
        .factor-value {
            padding: 0.375rem 0.75rem;
            border-radius: var(--radius-md);
            font-size: 0.875rem;
            font-weight: 600;
            text-transform: capitalize;
            text-align: center;
            border: 1px solid transparent;
        }
        
        .factor-value.very-low {
            background: var(--chip-bg-success);
            color: var(--success-color);
            border-color: var(--chip-br-success);
        }
        
        .factor-value.low {
            background: var(--chip-bg-info);
            color: var(--info-color);
            border-color: var(--chip-br-info);
        }
        
        .factor-value.medium {
            background: var(--chip-bg-warning);
            color: var(--warning-color);
            border-color: var(--chip-br-warning);
        }
        
        .factor-value.high {
            background: var(--chip-bg-orange);
            color: #f97316;
            border-color: var(--chip-br-orange);
        }
        
        .factor-value.very-high {
            background: var(--chip-bg-danger);
            color: var(--danger-color);
            border-color: var(--chip-br-danger);
        }
        
        .risk-mitigation {
            margin: 1rem 0;
            padding: 1rem;
            background: rgba(59, 130, 246, 0.1);
            border-radius: var(--radius-md);
            border-left: 4px solid var(--info-color);
            position: relative;
        }
        
        .risk-mitigation::before {
            content: 'üõ°Ô∏è';
            position: absolute;
            top: 1rem;
            right: 1rem;
            font-size: 1.25rem;
            opacity: 0.6;
        }
        
        .risk-mitigation strong {
            color: var(--info-color);
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
        }
        
        .risk-mitigation p {
            margin: 0;
            color: var(--text-primary);
            line-height: 1.5;
        }
        
        .risk-actions {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid var(--border-light);
        }
        
        /* Enhanced Search Results */
        .search-bar {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            align-items: center;
        }
        
        .search-bar input {
            flex: 1;
            padding: 0.75rem 1rem;
            border: 1px solid var(--border-light);
            border-radius: var(--radius-md);
            background: var(--bg-card);
            color: var(--text-primary);
            font-size: 1rem;
        }
        
        .search-bar input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
        
        .search-results {
            background: var(--bg-card);
            border-radius: var(--radius-lg);
            padding: 1.5rem;
            border: 1px solid var(--border-light);
            min-height: 200px;
            position: relative;
        }
        
        .spinner {
            border: 4px solid var(--border-light);
            border-top: 4px solid var(--primary-color);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            position: absolute;
            top: 50%;
            left: 50%;
            margin-top: -20px;
            margin-left: -20px;
            display: none; /* Initially hidden */
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .search-results-list {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin-top: 1rem;
        }
        
        .search-result-item {
            background: var(--bg-elevated);
            padding: 1rem;
            border-radius: var(--radius-md);
            border: 1px solid var(--border-light);
            transition: all 0.2s ease;
        }
        
        .search-result-item:hover {
            transform: translateY(-1px);
            box-shadow: var(--shadow-sm);
        }
        
        .search-result-item h4 {
            margin: 0.5rem 0;
            color: var(--text-primary);
            font-size: 1.1rem;
        }
        
        .search-result-item p {
            margin: 0.5rem 0;
            color: var(--text-secondary);
            line-height: 1.5;
        }
        
        .result-domain {
            display: inline-block;
            margin-top: 0.5rem;
            font-size: 0.85rem;
            color: var(--text-secondary);
            background: var(--bg-tertiary);
            padding: 0.25rem 0.5rem;
            border-radius: var(--radius-sm);
        }
        .result-type {
            padding: 0.25rem 0.75rem;
            border-radius: var(--radius-md);
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.025em;
        }
        
        .result-type.task {
            background: rgba(59, 130, 246, 0.2);
            color: var(--primary-color);
        }
        
        .result-type.risk {
            background: rgba(245, 158, 11, 0.2);
            color: var(--warning-color);
        }
        
        .result-type.project {
            background: rgba(139, 92, 246, 0.2);
            color: var(--accent-color);
        }
        
        .result-type.requirement {
            background: rgba(34, 197, 94, 0.2);
            color: var(--success-color);
        }
        
        .result-severity {
            display: inline-block;
            margin-left: 0.5rem;
            padding: 0.125rem 0.5rem;
            border-radius: var(--radius-md);
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
        }
        
        .result-severity.severity-low {
            background: var(--chip-bg-success);
            color: var(--success-color);
        }
        
        .result-severity.severity-medium {
            background: var(--chip-bg-warning);
            color: var(--warning-color);
        }
        
        .result-severity.severity-high {
            background: var(--chip-bg-orange);
            color: #f97316;
        }
        
        .result-severity.severity-critical {
            background: var(--chip-bg-danger);
            color: var(--danger-color);
        }

        /* Project header summary */
        .project-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            gap: 1rem;
        }
        .project-header-main {
            flex: 1 1 auto;
            min-width: 0;
        }
        .project-meta-row {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem 0.75rem;
            align-items: center;
            margin: 0.25rem 0 0.5rem 0;
        }
        .project-header-actions {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }
        .project-progress-compact { display: inline-flex; align-items: center; gap: 0.5rem; }
        .project-progress-compact #projectProgressText { font-size: 0.85rem; color: var(--text-secondary); }
        .progress-compact {
            width: 160px;
            height: 6px;
            background: var(--bg-elevated);
            border-radius: 999px;
            overflow: hidden;
            border: 1px solid var(--border-light);
        }
        .progress-compact-fill {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, var(--primary-color), var(--accent-color));
            transition: width 0.6s ease;
        }
        .due-chip {
            padding: 0.25rem 0.5rem;
            border-radius: var(--radius-md);
            font-size: 0.8rem;
            font-weight: 600;
            border: 1px solid transparent;
        }
        .due-chip.ok { background: var(--chip-bg-success); color: var(--success-color); border-color: var(--chip-br-success); }
        .due-chip.soon { background: var(--chip-bg-warning); color: var(--warning-color); border-color: var(--chip-br-warning); }
        .due-chip.overdue { background: var(--chip-bg-danger); color: var(--danger-color); border-color: var(--chip-br-danger); }
        
        /* Enhanced Tab System */
        .content-tabs {
            background: var(--bg-card);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border-light);
            overflow: hidden;
        }
        
        .tab-nav {
            display: flex;
            background: var(--bg-elevated);
            border-bottom: 1px solid var(--border-light);
        }
        
        .tab-btn {
            flex: 1;
            padding: 1rem 1.5rem;
            border: none;
            background: transparent;
            color: var(--text-secondary);
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
        }
        
        .tab-btn::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--primary-gradient);
            transform: scaleX(0);
            transition: transform 0.2s ease;
        }
        
        .tab-btn:hover {
            background: rgba(102, 126, 234, 0.1);
            color: var(--primary-color);
        }
        
        .tab-btn.active {
            background: var(--bg-card);
            color: var(--primary-color);
            font-weight: 600;
        }

        .tab-btn .tab-count {
            margin-left: 0.5rem;
            padding: 0 0.5rem;
            border-radius: 999px;
            font-size: 0.75rem;
            color: var(--text-secondary);
            background: var(--bg-elevated);
            border: 1px solid var(--border-light);
        }
        
        .tab-btn.active::after {
            transform: scaleX(1);
        }
        
        .tab-content {
            min-height: 300px;
        }
        
        .tab-pane {
            display: none;
            padding: 1.5rem;
        }
        
        .tab-pane.active {
            display: block;
        }
        
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border-light);
        }
        
        .section-header h3 {
            margin: 0;
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text-primary);
        }
        
        /* Responsive Design */
        @media (max-width: 1024px) {
            .domains-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }
        
        @media (max-width: 768px) {
            .header .container {
                padding: 0 1rem;
            }
            
            .nav {
                gap: 0.25rem;
            }
            
            .nav-btn {
                padding: 0.5rem 0.75rem;
                font-size: 0.875rem;
            }
            
            .view-header h2 {
                font-size: 2rem;
            }
            
            .subtitle {
                font-size: 1rem;
                padding: 0 1rem;
            }
            
            .domains-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .stats-overview {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .risk-matrix {
                flex-direction: column;
                gap: 1rem;
            }
            
            .tab-nav {
                flex-direction: column;
            }
            
            .modal-content {
                width: 95%;
                margin: 1rem;
            }
        }

        /* Risk Management Styles */
        .risk-card {
            border: 1px solid #e1e5e9;
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 12px;
            background: white;
            transition: box-shadow 0.2s ease;
        }
        
        .risk-card:hover {
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .risk-card.severity-low {
            border-left: 4px solid #28a745;
        }
        
        .risk-card.severity-medium {
            border-left: 4px solid #ffc107;
        }
        
        .risk-card.severity-high {
            border-left: 4px solid #fd7e14;
        }
        
        .risk-card.severity-critical {
            border-left: 4px solid #dc3545;
        }
        
        .risk-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 8px;
        }
        
        .risk-header h4 {
            margin: 0;
            color: #333;
            font-size: 1.1em;
        }
        
        .risk-severity {
            margin-left: 12px;
        }
        
        .severity-badge {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.8em;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.025em;
        }
        
        .severity-badge.low {
            background: #d4edda;
            color: #155724;
        }
        
        .severity-badge.medium {
            background: #fff3cd;
            color: #856404;
        }
        
        .severity-badge.high {
            background: #fde2e4;
            color: #721c24;
        }
        
        .severity-badge.critical {
            background: #f8d7da;
            color: #721c24;
        }
        
        .risk-description {
            color: #666;
            margin: 8px 0;
            line-height: 1.4;
        }
        
        .risk-matrix {
            display: flex;
            gap: 20px;
            margin: 12px 0;
            padding: 8px;
            background: #f8f9fa;
            border-radius: 4px;
        }
        
        .risk-factor {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }
        
        .factor-label {
            font-size: 0.85em;
            color: #666;
            font-weight: 500;
        }
        
        .factor-value {
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.9em;
            font-weight: 500;
            text-transform: capitalize;
        }
        
        .factor-value.very-low {
            background: #d4edda;
            color: #155724;
        }
        
        .factor-value.low {
            background: #d1ecf1;
            color: #0c5460;
        }
        
        .factor-value.medium {
            background: #fff3cd;
            color: #856404;
        }
        
        .factor-value.high {
            background: #fde2e4;
            color: #721c24;
        }
        
        .factor-value.very-high {
            background: #f8d7da;
            color: #721c24;
        }
        
        .risk-mitigation {
            margin: 12px 0;
            padding: 8px;
            background: #e7f3ff;
            border-radius: 4px;
            border-left: 3px solid #007bff;
        }
        
        .risk-mitigation strong {
            color: #0056b3;
        }
        
        .risk-mitigation p {
            margin: 4px 0 0 0;
            color: #333;
        }
        
        .risk-actions {
            display: flex;
            gap: 8px;
            margin-top: 12px;
        }
        
        /* Search result styles */
        .result-type.risk {
            background: #fff3cd;
            color: #856404;
        }
        
        .result-severity {
            display: inline-block;
            margin-left: 8px;
            padding: 2px 6px;
            border-radius: 8px;
            font-size: 0.8em;
            font-weight: 500;
        }

        /* Help & Support Styles */
        .help-content {
            max-width: 900px;
            margin: 0 auto;
            padding: 0 1rem;
        }

        .help-section {
            background: var(--surface-color);
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 2rem;
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
        }

        .help-section:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }

        .help-section h3 {
            color: var(--primary-color);
            font-size: 1.5rem;
            font-weight: 600;
            margin: 0 0 1rem 0;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .help-section p {
            line-height: 1.6;
            margin-bottom: 1rem;
            color: var(--text-primary);
        }

        .help-section p:last-child {
            margin-bottom: 0;
        }

        .help-section ul {
            margin: 1rem 0;
            padding-left: 1.5rem;
        }

        .help-section li {
            margin-bottom: 0.5rem;
            line-height: 1.6;
            color: var(--text-primary);
        }

        .help-section strong {
            color: var(--primary-color);
            font-weight: 600;
        }

        /* Footer Styles */
        .app-footer {
            background: var(--surface-color);
            border-top: 1px solid var(--border-color);
            margin-top: 2rem;
            padding: 1.5rem 0;
        }

        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .disclaimer {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .disclaimer p {
            margin: 0;
            font-size: 0.9rem;
            line-height: 1.4;
            color: var(--text-secondary);
        }

        .disclaimer strong {
            color: var(--warning-color);
            font-weight: 600;
        }

        .footer-meta {
            text-align: center;
            border-top: 1px solid var(--border-color);
            padding-top: 1rem;
        }

        .footer-meta p {
            margin: 0;
            font-size: 0.85rem;
            color: var(--text-muted);
            font-weight: 500;
        }

        /* Mobile responsiveness for help content and footer */
        @media (max-width: 768px) {
            .help-content {
                padding: 0 0.5rem;
            }
            
            .help-section {
                padding: 1.5rem;
                margin-bottom: 1.5rem;
            }
            
            .help-section h3 {
                font-size: 1.25rem;
            }

            .footer-content {
                padding: 0 1rem;
            }

            .disclaimer {
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <!-- Welcome Modal for First-Time Users -->
    <div id="welcomeModal" class="modal">
        <div class="modal-content">
            <h2>Welcome to PSPF Explorer 2025</h2>
            <p>Navigate the Australian Government Protective Security Policy Framework 2025 with this interactive compliance dashboard!</p>
            
            <div class="welcome-steps">
                <div class="step">
                    <div class="step-number">1</div>
                    <div class="step-content">
                        <h3>Six Security Domains</h3>
                        <p>Explore Governance, Risk, Information, Technology, Personnel, and Physical security domains with 2025 updates.</p>
                    </div>
                </div>
                <div class="step">
                    <div class="step-number">2</div>
                    <div class="step-content">
                        <h3>Track 2025 Requirements</h3>
                        <p>Monitor compliance with latest requirements including Zero Trust, post-quantum cryptography, and AI governance.</p>
                    </div>
                </div>
                <div class="step">
                    <div class="step-number">3</div>
                    <div class="step-content">
                        <h3>Real-time Compliance</h3>
                        <p>Track your organization's security posture with interactive dashboards and progress indicators.</p>
                    </div>
                </div>
            </div>
            
            <div class="pulse-demo">
                <h4>Key 2025 Updates:</h4>
                <ul class="welcome-list">
                    <li>üîí Mandatory CISO appointment with Audit Committee reporting</li>
                    <li>üõ°Ô∏è Zero Trust cybersecurity culture requirements</li>
                    <li>üîê Post-quantum cryptography for new systems</li>
                    <li>ü§ñ Enhanced AI and quantum technology governance</li>
                    <li>üë§ Stricter eligibility waiver and clearance protocols</li>
                </ul>
            </div>
            
            <button id="closeWelcome" class="btn btn-primary">Start Exploring</button>
        </div>
    </div>

    <!-- Header -->
    <header class="header">
        <div class="container">
            <h1 class="logo">PSPF Explorer</h1>
            <nav class="nav">
                <button id="homeBtn" class="nav-btn active">Home</button>
                <button id="searchBtn" class="nav-btn">Search</button>
                <button id="progressBtn" class="nav-btn">Progress</button>
                <button id="projectBtn" class="nav-btn">Projects</button>
                <button id="dataBtn" class="nav-btn">Data</button>
                <button id="helpBtn" class="nav-btn">Help</button>
            </nav>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main">
        <div class="container">
            <!-- Breadcrumb Navigation -->
            <nav class="breadcrumb" id="breadcrumb">
                <a href="#" data-level="home">PSPF Domains</a>
            </nav>

            <!-- Home View - Domain Overview -->
            <section id="homeView" class="view active">
                <div class="view-header">
                    <h2>PSPF 2025 Compliance Dashboard</h2>
                    <p class="subtitle">Interactive exploration of the Australian Government Protective Security Policy Framework 2025</p>
                </div>

                <div class="domains-grid" id="domainsGrid">
                    <!-- Domain cards will be dynamically generated -->
                </div>

                <!-- Welcome Dashboard (visible by default) -->
                <div class="welcome-dashboard" id="welcomeDashboard">
                    <div class="dashboard-header">
                        <h3>PSPF 2025 Framework Overview</h3>
                        <p class="dashboard-subtitle">Comprehensive protective security compliance tracking across all government domains</p>
                    </div>

                    <div class="dashboard-stats">
                        <div class="stat-card">
                            <div class="stat-number" id="totalRequirements">131</div>
                            <div class="stat-label">Total Requirements</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="totalDomains">6</div>
                            <div class="stat-label">Security Domains</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="totalProjects">0</div>
                            <div class="stat-label">Active Projects</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="complianceRate">0%</div>
                            <div class="stat-label">Compliance Rate</div>
                        </div>
                    </div>

                    <div class="dashboard-content">
                        <div class="domain-summary">
                            <h4>Domain Summary</h4>
                            <div class="domain-summary-grid" id="domainSummaryGrid">
                                <!-- Domain summary cards will be generated -->
                            </div>
                        </div>

                        <div class="quick-actions">
                            <h4>Quick Actions</h4>
                            <div class="action-cards">
                                <div class="action-card">
                                    <h5>üöÄ Get Started</h5>
                                    <p>Begin by exploring the Governance domain to understand leadership and accountability requirements.</p>
                                    <button class="btn btn-primary" onclick="window.pspfExplorer.showDomainRequirements('governance')">
                                        Explore Governance
                                    </button>
                                </div>
                                <div class="action-card">
                                    <h5>üìä Create Project</h5>
                                    <p>Start tracking your compliance progress by creating a new project or initiative.</p>
                                    <button class="btn btn-outline" onclick="window.pspfExplorer.showView('project'); window.pspfExplorer.updateNavButtons('projectBtn')">
                                        Create Project
                                    </button>
                                </div>
                                <div class="action-card">
                                    <h5>üìà View Progress</h5>
                                    <p>Monitor your overall compliance status and identify areas needing attention.</p>
                                    <button class="btn btn-outline" onclick="window.pspfExplorer.showView('progress'); window.pspfExplorer.updateNavButtons('progressBtn')">
                                        View Progress
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="pspf-highlights">
                        <h4>PSPF 2025 Key Updates</h4>
                        <div class="highlights-grid">
                            <div class="highlight-item">
                                <div class="highlight-icon">üîê</div>
                                <div class="highlight-content">
                                    <h6>Enhanced Cyber Security</h6>
                                    <p>Mandatory CISO appointments and Zero Trust architecture requirements</p>
                                </div>
                            </div>
                            <div class="highlight-item">
                                <div class="highlight-icon">üõ°Ô∏è</div>
                                <div class="highlight-content">
                                    <h6>Post-Quantum Cryptography</h6>
                                    <p>New requirements for quantum-resistant security measures</p>
                                </div>
                            </div>
                            <div class="highlight-item">
                                <div class="highlight-icon">üåê</div>
                                <div class="highlight-content">
                                    <h6>Foreign Interference</h6>
                                    <p>Strengthened protections against foreign interference and insider threats</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Requirements Section (initially hidden) -->
                <div class="requirements-section hidden" id="requirementsSection">
                    <div class="requirements-header">
                        <h3 id="selectedDomainTitle">Domain Requirements</h3>
                        <p id="selectedDomainDescription">Select a domain above to view its detailed description and requirements</p>
                    </div>
                    <div class="requirements-layout">
                        <div class="requirements-list">
                            <h4>Requirements List</h4>
                            <div class="requirements-sidebar" id="requirementsList">
                                <!-- Requirements list will be dynamically generated -->
                            </div>
                        </div>
                        <div class="requirement-details">
                            <div class="requirement-detail-content" id="requirementDetails">
                                <div class="placeholder-content">
                                    <h4>Select a Requirement</h4>
                                    <p>Choose a requirement from the list to view its details and compliance status.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Search View -->
            <section id="searchView" class="view">
                <div class="view-header">
                    <h2>Search</h2>
                    <div class="search-bar">
                        <input type="text" id="searchInput" placeholder="Search projects, tasks, activities, or events...">
                        <button id="searchSubmit" class="btn btn-primary">Search</button>
                    </div>
                </div>
                <div class="search-results" id="searchResults">
                    <div class="spinner" id="searchSpinner"></div>
                    <div class="empty-state">
                        <h3>üîç Search Your Data</h3>
                        <p>Enter a search term above to find projects, tasks, risks, or requirements across your entire dataset.</p>
                    </div>
                </div>
            </section>

            <!-- Progress View -->
            <section id="progressView" class="view">
                <div class="view-header">
                    <h2>Progress Overview</h2>
                    <p class="subtitle">Track your compliance journey across all domains</p>
                </div>
                
                <div class="stats-overview" id="statsOverview">
                    <div class="stat-card">
                        <div class="stat-header">
                            <div>
                                <span class="stat-number" id="totalProjects">0</span>
                                <span class="stat-label">Active Projects</span>
                            </div>
                            <span class="stat-icon">üìä</span>
                        </div>
                        <div class="mini-chart">
                            <div class="mini-chart-bar" id="projectsChart"></div>
                        </div>
                        <div class="stat-trend trend-neutral" id="projectsTrend">
                            <span>‚Üí</span> No change
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-header">
                            <div>
                                <span class="stat-number" id="totalTasks">0</span>
                                <span class="stat-label">Total Tasks</span>
                            </div>
                            <span class="stat-icon">‚úÖ</span>
                        </div>
                        <div class="mini-chart">
                            <div class="mini-chart-bar" id="tasksChart"></div>
                        </div>
                        <div class="stat-trend trend-neutral" id="tasksTrend">
                            <span>‚Üí</span> No change
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-header">
                            <div>
                                <span class="stat-number" id="completedTasks">0</span>
                                <span class="stat-label">Completed Tasks</span>
                            </div>
                            <div class="progress-ring" id="taskCompletionRing">
                                <svg>
                                    <circle class="progress-ring-background" cx="30" cy="30" r="26"></circle>
                                    <circle class="progress-ring-progress" cx="30" cy="30" r="26" 
                                            stroke-dasharray="163.36" stroke-dashoffset="163.36"></circle>
                                </svg>
                                <div class="progress-ring-text" id="taskCompletionPercent">0%</div>
                            </div>
                        </div>
                        <div class="stat-trend trend-neutral" id="completionTrend">
                            <span>‚Üí</span> No change
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-header">
                            <div>
                                <span class="stat-number" id="overallCompliance">0%</span>
                                <span class="stat-label">Requirements Met</span>
                            </div>
                            <div class="progress-ring" id="complianceRing">
                                <svg>
                                    <circle class="progress-ring-background" cx="30" cy="30" r="26"></circle>
                                    <circle class="progress-ring-progress" cx="30" cy="30" r="26" 
                                            stroke-dasharray="163.36" stroke-dashoffset="163.36"></circle>
                                </svg>
                                <div class="progress-ring-text" id="compliancePercent">0%</div>
                            </div>
                        </div>
                        <div class="stat-trend trend-neutral" id="complianceTrend">
                            <span>‚Üí</span> No change
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-header">
                            <div>
                                <span class="stat-number" id="totalRisks">0</span>
                                <span class="stat-label">Active Risks</span>
                            </div>
                            <span class="stat-icon">‚ö†Ô∏è</span>
                        </div>
                        <div class="mini-chart">
                            <div class="mini-chart-bar risk-chart" id="risksChart"></div>
                        </div>
                        <div class="stat-trend trend-neutral" id="risksTrend">
                            <span>‚Üí</span> Risk level stable
                        </div>
                    </div>
                </div>
                
                <div class="progress-grid" id="progressGrid">
                    <!-- Progress cards will be dynamically generated -->
                </div>
            </section>

            <!-- Data Management View -->
            <section id="dataView" class="view">
                <div class="view-header">
                    <h2>Data Management</h2>
                    <p class="subtitle">Export, import, and manage your PSPF Explorer data</p>
                </div>
                
                <div class="data-management">
                    <div class="data-section">
                        <div class="data-card">
                            <h3>üóÇÔ∏è Export Data</h3>
                            <p>Download all your projects, tasks, activities, and events as a backup file.</p>
                            <button id="exportDataBtn" class="btn btn-primary">Export All Data</button>
                        </div>
                        
                        <div class="data-card">
                            <h3>üì• Import Data</h3>
                            <p>Restore data from a previously exported backup file.</p>
                            <input type="file" id="importFileInput" accept=".json" class="hidden" title="Select backup file to import">
                            <button id="importDataBtn" class="btn btn-secondary">Import Data</button>
                        </div>
                        
                        <div class="data-card warning">
                            <h3>üóëÔ∏è Clear Data</h3>
                            <p>Remove all data and start fresh. This action cannot be undone.</p>
                            <button id="clearDataBtn" class="btn btn-danger">Clear All Data</button>
                        </div>
                    </div>
                    
                    <div class="data-info">
                        <h3>üìä Data Summary</h3>
                        <div class="data-stats">
                            <div class="stat-item">
                                <span class="stat-label">Projects:</span>
                                <span class="stat-value" id="dataProjectCount">0</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Tasks:</span>
                                <span class="stat-value" id="dataTaskCount">0</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Activities:</span>
                                <span class="stat-value" id="dataRiskCount">0</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Events:</span>
                                <span class="stat-value" id="dataIncidentCount">0</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Last Modified:</span>
                                <span class="stat-value" id="dataLastModified">Never</span>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Project Management View -->
            <section id="projectView" class="view">
                <div class="view-header">
                    <h2>Project Management</h2>
                    <p class="subtitle">Manage your compliance projects and activities</p>
                    <button id="addProjectBtn" class="btn btn-primary">Add New Project</button>
                </div>
                
                <div class="projects-layout">
                    <div class="projects-list-panel">
                        <h4>Projects List</h4>
                        <div class="projects-sidebar" id="projectsList">
                            <!-- Projects list will be dynamically generated -->
                        </div>
                    </div>
                    <div class="project-details-panel">
                        <div class="project-detail-content" id="projectDetails">
                            <div class="placeholder-content">
                                <h4>Select a Project</h4>
                                <p>Choose a project from the list to view its details and manage tasks.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Help View -->
            <section id="helpView" class="view">
                <div class="view-header">
                    <h2>Help & Support</h2>
                    <p class="subtitle">Learn how to use PSPF Explorer effectively</p>
                </div>
                <div class="help-content">
                    <div class="help-section">
                        <h3>üéØ What is PSPF Explorer?</h3>
                        <p>PSPF Explorer transforms the Australian Government Protective Security Policy Framework (PSPF) from static documents into an interactive, engaging experience. Instead of reading through PowerPoint presentations or PDFs, you can explore security requirements dynamically and see how your work contributes to organizational security.</p>
                        <p><strong>Who is it for?</strong> Everyone in the organization - from executives to frontline staff. This tool is designed for universal access with plain-language explanations that make complex security requirements accessible to all.</p>
                    </div>

                    <div class="help-section">
                        <h3>üöÄ Getting Started</h3>
                        <p><strong>Start with the Home page:</strong> The six PSPF domains are displayed as interactive cards across the top. Each domain shows its current compliance status through visual indicators.</p>
                        <p><strong>Explore domains:</strong> Click on any domain to see its specific requirements. Each requirement explains what needs to be done in practical, everyday language.</p>
                        <p><strong>Track progress:</strong> Use the visual cues and progress indicators to understand which areas need attention and celebrate your achievements.</p>
                    </div>

                    <div class="help-section">
                        <h3>üìä Understanding the Structure</h3>
                        <p>PSPF Explorer follows a simple hierarchy that you can navigate both top-down and bottom-up:</p>
                        <ul>
                            <li><strong>Domains</strong> ‚Üí Core PSPF areas (fixed structure)</li>
                            <li><strong>Requirements</strong> ‚Üí Specific security requirements within each domain (fixed structure)</li>
                            <li><strong>Projects</strong> ‚Üí Your work initiatives to meet requirements (you can create and manage these)</li>
                            <li><strong>Tasks</strong> ‚Üí Specific actions within projects (you can create and manage these)</li>
                            <li><strong>Risks</strong> ‚Üí Potential issues to track (you can create and manage these)</li>
                        </ul>
                    </div>

                    <div class="help-section">
                        <h3>‚úÖ Managing Compliance</h3>
                        <p><strong>Binary tracking:</strong> Each requirement is either met (Yes) or not met (No). All requirements start as "No" and must be manually updated to "Yes" when completed.</p>
                        <p><strong>Adding context:</strong> Use the comment field for each requirement to add notes, context, or progress updates. Comments are hidden once a requirement is marked as complete.</p>
                        <p><strong>Visual feedback:</strong> Your compliance progress drives the visual indicators throughout the system, giving you instant feedback on your security posture.</p>
                    </div>

                    <div class="help-section">
                        <h3>üéØ Working with Projects</h3>
                        <p><strong>Create projects:</strong> Go to the Projects tab to create new compliance initiatives. Projects help organize your work toward meeting specific requirements.</p>
                        <p><strong>Manage tasks:</strong> Within each project, create tasks for specific actions that need to be completed.</p>
                        <p><strong>Track risks:</strong> Identify and track potential issues that could impact your compliance work.</p>
                        <p><strong>Two-column layout:</strong> The Projects page uses a list-and-details layout - select a project from the left to see its details on the right.</p>
                    </div>

                    <div class="help-section">
                        <h3>üìà Progress Overview</h3>
                        <p>The Progress tab provides a comprehensive view of your compliance journey:</p>
                        <ul>
                            <li><strong>Statistics cards:</strong> See key metrics like active projects, total tasks, completion rates, and compliance percentages</li>
                            <li><strong>Domain progress:</strong> Visual representation of progress across all PSPF domains</li>
                            <li><strong>Trends:</strong> Track how your compliance posture is improving over time</li>
                        </ul>
                    </div>

                    <div class="help-section">
                        <h3>üîç Search & Data Management</h3>
                        <p><strong>Search functionality:</strong> Use the Search tab to find specific projects, tasks, risks, or requirements across your entire dataset.</p>
                        <p><strong>Data backup:</strong> The Data tab allows you to export your work for backup or import data from previous sessions.</p>
                        <p><strong>Local storage:</strong> Your data is stored locally in your browser, so it persists between sessions on the same device.</p>
                    </div>

                    <div class="help-section">
                        <h3>üí° Tips for Success</h3>
                        <ul>
                            <li><strong>Start small:</strong> Begin with one domain and gradually expand your compliance tracking</li>
                            <li><strong>Regular updates:</strong> Check in frequently to update progress and maintain momentum</li>
                            <li><strong>Use plain language:</strong> When adding comments or project descriptions, write in terms that anyone can understand</li>
                            <li><strong>Celebrate progress:</strong> Acknowledge both individual and team achievements as you improve compliance</li>
                            <li><strong>Connect daily work:</strong> Link routine activities to security requirements to show how everyday actions contribute to organizational security</li>
                        </ul>
                    </div>

                    <div class="help-section">
                        <h3>üé® Visual Cues</h3>
                        <p><strong>Progress indicators:</strong> Circular progress rings show completion percentages at a glance</p>
                        <p><strong>Status colors:</strong> Green indicates completion, amber shows progress, and red highlights areas needing attention</p>
                        <p><strong>Interactive elements:</strong> Hover effects and animations guide you toward important information</p>
                        <p><strong>Responsive design:</strong> The interface adapts to different screen sizes for optimal viewing on any device</p>
                    </div>

                    <div class="help-section">
                        <h3>ü§ù Getting Help</h3>
                        <p>PSPF Explorer is designed to be intuitive and self-explanatory. If you encounter any issues:</p>
                        <ul>
                            <li>Try refreshing the page to resolve temporary issues</li>
                            <li>Check that you're using a modern web browser</li>
                            <li>Ensure JavaScript is enabled in your browser settings</li>
                            <li>Use the export function in the Data tab to backup your work regularly</li>
                        </ul>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <!-- Footer -->
    <footer class="app-footer">
        <div class="footer-content">
            <div class="disclaimer">
                <p><strong>‚ö†Ô∏è Experimental Tool:</strong> This is an experiment and should not be relied upon for decision making.</p>
                <p><strong>ü§ñ AI Assistance:</strong> This application was developed with assistance from generative artificial intelligence tools.</p>
            </div>
            <div class="footer-meta">
                <p>PSPF Explorer ‚Ä¢ Australian Government Protective Security Policy Framework 2025</p>
            </div>
        </div>
    </footer>

    <!-- CRUD Modals -->
    <!-- Project Modal -->
    <div id="projectModal" class="modal">
        <div class="modal-content">
            <h3 id="projectModalTitle">Add Project</h3>
            <form id="projectForm">
                <div class="form-group">
                    <label for="projectName">Project Name</label>
                    <input type="text" id="projectName" required>
                </div>
                <div class="form-group">
                    <label for="projectDesc">Description</label>
                    <textarea id="projectDesc" rows="3"></textarea>
                </div>
                <div class="form-group">
                    <label for="projectStatusSelect">Status</label>
                    <select id="projectStatusSelect">
                        <option value="planning">Planning</option>
                        <option value="active">Active</option>
                        <option value="on-hold">On Hold</option>
                        <option value="completed">Completed</option>
                    </select>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" id="cancelProject">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Project</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Link Requirements Modal -->
    <div id="linkRequirementsModal" class="modal">
        <div class="modal-content">
            <h3>Link Requirements</h3>
            <div class="form-group">
                <label for="requirementsSearch">Filter</label>
                <input type="text" id="requirementsSearch" placeholder="Search by title or ID">
            </div>
            <div id="requirementsChecklist" class="requirements-checklist">
                <!-- Populated dynamically with checkboxes grouped by domain -->
            </div>
            <div class="modal-actions">
                <button type="button" id="cancelLinkRequirements" class="btn btn-secondary">Cancel</button>
                <button type="button" id="saveLinkRequirements" class="btn btn-primary">Save Links</button>
            </div>
        </div>
    </div>

    <!-- Task Modal -->
    <div id="taskModal" class="modal">
        <div class="modal-content">
            <h3 id="taskModalTitle">Add Task</h3>
            <form id="taskForm">
                <div class="form-group">
                    <label for="taskName">Task Name</label>
                    <input type="text" id="taskName" required>
                </div>
                <div class="form-group">
                    <label for="taskDesc">Description</label>
                    <textarea id="taskDesc" rows="3"></textarea>
                </div>
                <div class="form-group">
                    <label for="taskStatus">Status</label>
                    <select id="taskStatus">
                        <option value="not-started">Not Started</option>
                        <option value="in-progress">In Progress</option>
                        <option value="completed">Completed</option>
                        <option value="blocked">Blocked</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="taskAssignee">Assignee</label>
                    <input type="text" id="taskAssignee">
                </div>
                <div class="form-group">
                    <label for="taskDueDate">Due Date</label>
                    <input type="date" id="taskDueDate">
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" id="cancelTask">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Task</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Risk Modal -->
    <div id="riskModal" class="modal">
        <div class="modal-content">
            <h3 id="riskModalTitle">Add Risk</h3>
            <form id="riskForm">
                <div class="form-group">
                    <label for="riskName">Risk Title</label>
                    <input type="text" id="riskName" required>
                </div>
                <div class="form-group">
                    <label for="riskDesc">Description</label>
                    <textarea id="riskDesc" rows="3"></textarea>
                </div>
                <div class="form-group">
                    <label for="riskLikelihood">Likelihood</label>
                    <select id="riskLikelihood">
                        <option value="very-low">Very Low</option>
                        <option value="low">Low</option>
                        <option value="medium">Medium</option>
                        <option value="high">High</option>
                        <option value="very-high">Very High</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="riskImpact">Impact</label>
                    <select id="riskImpact">
                        <option value="very-low">Very Low</option>
                        <option value="low">Low</option>
                        <option value="medium">Medium</option>
                        <option value="high">High</option>
                        <option value="very-high">Very High</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="riskMitigation">Mitigation Strategy</label>
                    <textarea id="riskMitigation" rows="3"></textarea>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" id="cancelRisk">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Risk</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Event Modal -->
    <div id="incidentModal" class="modal">
        <div class="modal-content">
            <h3 id="incidentModalTitle">Add Event</h3>
            <form id="incidentForm">
                <div class="form-group">
                    <label for="incidentName">Event Title</label>
                    <input type="text" id="incidentName" required>
                </div>
                <div class="form-group">
                    <label for="incidentDesc">Description</label>
                    <textarea id="incidentDesc" rows="4"></textarea>
                </div>
                <div class="form-group">
                    <label for="incidentDate">Date Occurred</label>
                    <input type="datetime-local" id="incidentDate" required>
                </div>
                <div class="form-group">
                    <label for="incidentSeverity">Impact Level</label>
                    <select id="incidentSeverity">
                        <option value="low">Low</option>
                        <option value="medium">Medium</option>
                        <option value="high">High</option>
                        <option value="critical">Critical</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="incidentResolution">Resolution/Action Taken</label>
                    <textarea id="incidentResolution" rows="3"></textarea>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" id="cancelIncident">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Event</button>
                </div>
            </form>
        </div>
    </div>

    <script>
    class PSPFExplorer {
        constructor() {
            // Initialize data structures
            this.projects = JSON.parse(localStorage.getItem('pspf_projects') || '[]');
            this.tasks = JSON.parse(localStorage.getItem('pspf_tasks') || '[]');
            this.risks = JSON.parse(localStorage.getItem('pspf_risks') || '[]');
            this.incidents = JSON.parse(localStorage.getItem('pspf_incidents') || '[]');
            this.compliance = JSON.parse(localStorage.getItem('pspf_compliance') || '{}');
            
            this.currentView = 'home';
            this.selectedDomain = null;
            this.editingProject = null;
            this.editingTask = null;
            this.editingRisk = null;
            this.editingIncident = null;
            
            this.init();
        }

        init() {
            this.loadDomainData();
            this.setupEventListeners();
            this.showWelcomeModalIfFirstTime();
            this.renderHome();
            this.updateDataStats();
        }

        loadDomainData() {
            this.domains = [
                {
                    id: 'governance',
                    title: 'Governance',
                    description: 'Security governance, accountability, and leadership roles including Chief Security Officer (CSO) and Chief Information Security Officer (CISO) appointments.',
                    requirements: ['GOV-001', 'GOV-002', 'GOV-003', 'GOV-004', 'GOV-005', 'GOV-006', 'GOV-007', 'GOV-008', 'GOV-009', 'GOV-010', 'GOV-011', 'GOV-012', 'GOV-013', 'GOV-014', 'GOV-015', 'GOV-016', 'GOV-017', 'GOV-018', 'GOV-019', 'GOV-020', 'GOV-021', 'GOV-022', 'GOV-023', 'GOV-024', 'GOV-025', 'GOV-026', 'GOV-027', 'GOV-028', 'GOV-029', 'GOV-030', 'GOV-031', 'GOV-032', 'GOV-033', 'GOV-034', 'GOV-035']
                },
                {
                    id: 'risk',
                    title: 'Risk Management',
                    description: 'Security risk management aligned with enterprise risk, including third-party, supply chain, and foreign interference risk management.',
                    requirements: ['RISK-001', 'RISK-002', 'RISK-003', 'RISK-004', 'RISK-005', 'RISK-006', 'RISK-007', 'RISK-008', 'RISK-009', 'RISK-010', 'RISK-011', 'RISK-012', 'RISK-013', 'RISK-014', 'RISK-015', 'RISK-016', 'RISK-017', 'RISK-018', 'RISK-019', 'RISK-020', 'RISK-021', 'RISK-022']
                },
                {
                    id: 'information',
                    title: 'Information Security',
                    description: 'Protective markings, classifications (OFFICIAL, PROTECTED, SECRET, TOP SECRET), need-to-know principle and secure handling requirements.',
                    requirements: ['INFO-001', 'INFO-002', 'INFO-003', 'INFO-004', 'INFO-005', 'INFO-006', 'INFO-007', 'INFO-008', 'INFO-009', 'INFO-010', 'INFO-011', 'INFO-012', 'INFO-013', 'INFO-014', 'INFO-015', 'INFO-016', 'INFO-017', 'INFO-018', 'INFO-019', 'INFO-020', 'INFO-021', 'INFO-022', 'INFO-023', 'INFO-024', 'INFO-025', 'INFO-026']
                },
                {
                    id: 'technology',
                    title: 'Technology Security',
                    description: 'Cybersecurity strategy with zero trust culture, AI/quantum technology policies, Essential Eight mitigation strategies, and cloud security requirements.',
                    requirements: ['TECH-001', 'TECH-002', 'TECH-003', 'TECH-004', 'TECH-005', 'TECH-006', 'TECH-007', 'TECH-008', 'TECH-009', 'TECH-010', 'TECH-011', 'TECH-012', 'TECH-013', 'TECH-014', 'TECH-015', 'TECH-016', 'TECH-017', 'TECH-018', 'TECH-019', 'TECH-020', 'TECH-021', 'TECH-022', 'TECH-023', 'TECH-024']
                },
                {
                    id: 'personnel',
                    title: 'Personnel Security',
                    description: 'Pre-employment screening, security clearance processes, conditional clearance management, and eligibility waiver protocols.',
                    requirements: ['PERS-001', 'PERS-002', 'PERS-003', 'PERS-004', 'PERS-005', 'PERS-006', 'PERS-007', 'PERS-008', 'PERS-009', 'PERS-010', 'PERS-011', 'PERS-012']
                },
                {
                    id: 'physical',
                    title: 'Physical Security',
                    description: 'Security planning for facilities, certification and accreditation of physical assets, access controls, and technical surveillance measures.',
                    requirements: ['PHYS-001', 'PHYS-002', 'PHYS-003', 'PHYS-004', 'PHYS-005', 'PHYS-006', 'PHYS-007', 'PHYS-008', 'PHYS-009', 'PHYS-010', 'PHYS-011', 'PHYS-012']
                }
            ];

            this.requirements = {
                // Governance Domain - First 12 Requirements
                'GOV-001': { id: 'GOV-001', domainId: 'governance', title: 'Department of State supports portfolio entities', description: 'Department of State provides security advice and guidance to support portfolio entities in implementing protective security measures and maintaining compliance.' },
                'GOV-002': { id: 'GOV-002', domainId: 'governance', title: 'Accountable Authority complies with security directions', description: 'Accountable Authority must comply with all security directions issued by relevant oversight bodies and maintain accountability for security within the entity.' },
                'GOV-003': { id: 'GOV-003', domainId: 'governance', title: 'Technical Authority Entity provides security advice', description: 'Technical Authority Entity provides specialist security advice and technical guidance to support effective protective security implementation.' },
                'GOV-004': { id: 'GOV-004', domainId: 'governance', title: 'Shared Service Provider Entity supplies security services', description: 'Shared Service Provider Entity supplies consistent security services across multiple entities to ensure standardized protective security approaches.' },
                'GOV-005': { id: 'GOV-005', domainId: 'governance', title: 'Documented responsibilities for partnerships', description: 'Document clear responsibilities and accountabilities for partnerships, service arrangements, and collaborative security activities.' },
                'GOV-006': { id: 'GOV-006', domainId: 'governance', title: 'Accountable Authority answerable to Minister', description: 'Accountable Authority is answerable to the Minister for all security matters within their entity and maintains clear reporting lines.' },
                'GOV-007': { id: 'GOV-007', domainId: 'governance', title: 'Accountable Authority manages security risks', description: 'Accountable Authority manages and oversees all security risks for the entity, ensuring appropriate governance and accountability structures.' },
                'GOV-008': { id: 'GOV-008', domainId: 'governance', title: 'Appoint Chief Security Officer', description: 'Entity must appoint a Chief Security Officer with appropriate authority and responsibility for overall protective security governance and implementation.' },
                'GOV-009': { id: 'GOV-009', domainId: 'governance', title: 'CSO requirements and clearance level', description: 'CSO must be at SES level and hold minimum "Negative Vetting 1" clearance with appropriate professional qualifications and experience.' },
                'GOV-010': { id: 'GOV-010', domainId: 'governance', title: 'CSO accountability to Accountable Authority', description: 'CSO is directly accountable to the Accountable Authority for all security matters and provides regular reporting on security posture.' },
                'GOV-011': { id: 'GOV-011', domainId: 'governance', title: 'Chief Information Security Officer oversight', description: 'CISO oversees cyber security program and critical technology resources, providing specialized leadership for cyber security initiatives.' },
                'GOV-012': { id: 'GOV-012', domainId: 'governance', title: 'CISO capability and clearance requirements', description: 'CISO must have appropriate cyber security capability and hold minimum "Negative Vetting 1" clearance to effectively manage cyber security risks.' },
                'GOV-013': { id: 'GOV-013', domainId: 'governance', title: 'CISO accountability for cyber risk and program', description: 'The CISO is accountable to the Accountable Authority for cyber security risks and how the entity\'s cyber security program is managing these risks.' },
                'GOV-014': { id: 'GOV-014', domainId: 'governance', title: 'Security practitioner resourcing', description: 'Security practitioners (where appointed) are skilled, empowered, and resourced to perform required functions effectively.' },
                'GOV-015': { id: 'GOV-015', domainId: 'governance', title: 'Practitioner security training', description: 'Security practitioners (where appointed) have access to relevant training to keep abreast of emerging and evolving security issues.' },
                'GOV-016': { id: 'GOV-016', domainId: 'governance', title: 'Governance approval matches entity risk', description: 'The Accountable Authority approves security governance arrangements suitable for the entity\'s size, complexity and risk profile.' },
                'GOV-017': { id: 'GOV-017', domainId: 'governance', title: 'Dedicated security email channel', description: 'The entity establishes and monitors a dedicated security email address for security communications and notifications.' },
                'GOV-018': { id: 'GOV-018', domainId: 'governance', title: 'Security plan development, implementation, maintenance', description: 'The entity develops, implements, and maintains a security plan that addresses mandatory elements specified by this Framework.' },
                'GOV-019': { id: 'GOV-019', domainId: 'governance', title: 'Security plan authority approval', description: 'The Accountable Authority approves the entity\'s security plan to ensure appropriate oversight and governance.' },
                'GOV-020': { id: 'GOV-020', domainId: 'governance', title: 'Security plan annual consideration and review', description: 'The entity considers its security plan annually and reviews it at least every two years to ensure continued relevance.' },
                'GOV-021': { id: 'GOV-021', domainId: 'governance', title: 'Security actions and procedures', description: 'The entity implements procedures to ensure all elements detailed in the security plan are achieved and maintained.' },
                'GOV-022': { id: 'GOV-022', domainId: 'governance', title: 'Security monitoring', description: 'The entity monitors compliance with the plan and regularly assesses the effectiveness of its security measures.' },
                'GOV-023': { id: 'GOV-023', domainId: 'governance', title: 'Security risk culture', description: 'The entity fosters and maintains a positive security risk culture, modelled and promoted by its leaders.' },
                'GOV-024': { id: 'GOV-024', domainId: 'governance', title: 'Security awareness activities', description: 'The security awareness activities meet mandatory requirements and needs of entity and staff for effective security culture.' },
                'GOV-025': { id: 'GOV-025', domainId: 'governance', title: 'Security incidents: procedures and response', description: 'The entity develops and maintains procedures to detect, report, record, and respond to security incidents effectively.' },
                'GOV-026': { id: 'GOV-026', domainId: 'governance', title: 'Security incident reporting', description: 'Significant or externally reportable security incidents are reported to the appropriate authorities per relevant government directions.' },
                'GOV-027': { id: 'GOV-027', domainId: 'governance', title: 'Security review and lessons learned', description: 'After a significant incident, the entity reviews actions and outcomes, integrating lessons learned into ongoing programs.' },
                'GOV-028': { id: 'GOV-028', domainId: 'governance', title: 'Assurance activities follow-up', description: 'The entity undertakes and responds to assurance activities (e.g., audits), rectifying deficiencies and informing the CSO.' },
                'GOV-029': { id: 'GOV-029', domainId: 'governance', title: 'Annual security report preparation', description: 'The entity prepares an annual report on performance against the PSPF and submits it to the responsible Minister and Home Affairs.' },
                'GOV-030': { id: 'GOV-030', domainId: 'governance', title: 'Cyber health check survey', description: 'The entity completes the required annual ASD Cyber Security Survey for the Minister for Home Affairs.' },
                'GOV-031': { id: 'GOV-031', domainId: 'governance', title: 'Security direction planning and implementation', description: 'Security directions are planned and implemented, with any changes recorded and actioned in the security plan.' },
                'GOV-032': { id: 'GOV-032', domainId: 'governance', title: 'Security plan communication', description: 'The entity communicates security plan arrangements to all relevant personnel to ensure understanding and compliance.' },
                'GOV-033': { id: 'GOV-033', domainId: 'governance', title: 'Security roles and responsibilities communication', description: 'The entity communicates the security roles, responsibilities, and accountabilities across the entity for clear governance.' },
                'GOV-034': { id: 'GOV-034', domainId: 'governance', title: 'Audit committee security risk coverage', description: 'Security matters are a standing agenda item for the Audit Committee; the CISO/CSO has direct reporting capability to the Committee.' },
                'GOV-035': { id: 'GOV-035', domainId: 'governance', title: 'Protecting whistleblowers and critical security reports', description: 'Security framework protects and encourages whistleblowers and early reporters of critical security issues.' },

                // Risk Domain - First 12 Requirements
                'RISK-001': { id: 'RISK-001', domainId: 'risk', title: 'Document risk tolerance in security plan', description: 'Document clear risk tolerance levels in the entity security plan, establishing acceptable risk thresholds and decision-making criteria.' },
                'RISK-002': { id: 'RISK-002', domainId: 'risk', title: 'Assign risk steward for security risks', description: 'Assign dedicated risk steward or manager for each category of security risk to ensure clear ownership and accountability.' },
                'RISK-003': { id: 'RISK-003', domainId: 'risk', title: 'Share security risk information appropriately', description: 'Share security risk information with relevant stakeholders where appropriate to enable coordinated risk management across entities.' },
                'RISK-004': { id: 'RISK-004', domainId: 'risk', title: 'Manage risks from procurement and contracts', description: 'Entities must actively manage security risks arising from procurement activities and contractual arrangements with external providers.' },
                'RISK-005': { id: 'RISK-005', domainId: 'risk', title: 'Security terms in contracts and PSPF compliance', description: 'Contracts must include appropriate security terms and ensure providers follow relevant PSPF requirements throughout the contract lifecycle.' },
                'RISK-006': { id: 'RISK-006', domainId: 'risk', title: 'Ensure provider PSPF compliance', description: 'Ensure all service providers comply with relevant PSPF requirements appropriate to their level of access and service delivery.' },
                'RISK-007': { id: 'RISK-007', domainId: 'risk', title: 'Contract incident reporting and compliance', description: 'Contract terms must mandate incident reporting procedures and require compliance with security directions throughout the contract period.' },
                'RISK-008': { id: 'RISK-008', domainId: 'risk', title: 'IRAP assessment reports for outsourced providers', description: 'Outsourced providers must provide Information Security Registered Assessors Program (IRAP) assessment reports for relevant systems and services.' },
                'RISK-009': { id: 'RISK-009', domainId: 'risk', title: 'Monitor and review contract security controls', description: 'Continuously monitor and review contract terms to ensure security controls are working effectively and remain appropriate.' },
                'RISK-010': { id: 'RISK-010', domainId: 'risk', title: 'Contract completion and termination security', description: 'Contracts must include comprehensive security arrangements for completion, termination, and transition of services to protect ongoing operations.' },
                'RISK-011': { id: 'RISK-011', domainId: 'risk', title: 'Foreign ownership and control risk management', description: 'Foreign ownership and control risks must be addressed before contract commencement and continuously managed throughout the contract period.' },
                'RISK-012': { id: 'RISK-012', domainId: 'risk', title: 'Continual third-party contract risk management', description: 'Continuously manage and reassess third-party contract risks throughout the relationship lifecycle, adapting controls as needed.' },
                'RISK-013': { id: 'RISK-013', domainId: 'risk', title: 'Secure vendor selection', description: 'Third-party vendors and providers are chosen as secure and verifiable sources by default to minimize security risk exposure.' },
                'RISK-014': { id: 'RISK-014', domainId: 'risk', title: 'Vendor risk management', description: 'Evaluate and manage security risks when engaging vendors and suppliers throughout the procurement and service delivery lifecycle.' },
                'RISK-015': { id: 'RISK-015', domainId: 'risk', title: 'Foreign interference program', description: 'Maintain insider threat and foreign interference program as part of comprehensive risk management to protect against internal threats.' },
                'RISK-016': { id: 'RISK-016', domainId: 'risk', title: 'Monitor insider threat', description: 'Monitor, assess and address emerging risks of insider threats to entity security through appropriate detection and mitigation measures.' },
                'RISK-017': { id: 'RISK-017', domainId: 'risk', title: 'Contingency planning', description: 'Establish and maintain contingency plans for security incidents and business continuity to ensure operational resilience.' },
                'RISK-018': { id: 'RISK-018', domainId: 'risk', title: 'Business continuity', description: 'Business continuity plans are kept and regularly tested to mitigate disruptions affecting security and operations.' },
                'RISK-019': { id: 'RISK-019', domainId: 'risk', title: 'Critical incident management', description: 'Entities maintain procedures and structures for critical incident management, escalation, and response to ensure effective crisis handling.' },
                'RISK-020': { id: 'RISK-020', domainId: 'risk', title: 'Emergency security arrangements', description: 'Emergency arrangements consider security impacts to people, information and assets during crisis situations and emergency responses.' },
                'RISK-021': { id: 'RISK-021', domainId: 'risk', title: 'Threat and vulnerability assessments', description: 'Ongoing threat and vulnerability assessments are conducted as part of the risk management framework to identify and address security gaps.' },
                'RISK-022': { id: 'RISK-022', domainId: 'risk', title: 'Shared or government-wide risks', description: 'Risks that share impact across other entities or the government are managed and communicated appropriately for coordinated response.' },

                // Information Domain - First 12 Requirements
                'INFO-001': { id: 'INFO-001', domainId: 'information', title: 'Originator controls information handling', description: 'Information originator controls sanitisation, reclassification, and declassification decisions, maintaining authority over information lifecycle management.' },
                'INFO-002': { id: 'INFO-002', domainId: 'information', title: 'Assess value and sensitivity of information', description: 'Value and sensitivity of official information must be assessed by the originator to determine appropriate protective measures and handling requirements.' },
                'INFO-003': { id: 'INFO-003', domainId: 'information', title: 'Set classification at lowest reasonable level', description: 'Set information classification at the lowest reasonable level that provides adequate protection while enabling appropriate access and sharing.' },
                'INFO-004': { id: 'INFO-004', domainId: 'information', title: 'Mark classified information appropriately', description: 'Security-classified information must be clearly marked with appropriate classification level and caveat markings where relevant to ensure proper handling.' },
                'INFO-005': { id: 'INFO-005', domainId: 'information', title: 'Apply minimum protections to information', description: 'Apply minimum protective measures to OFFICIAL and classified information commensurate with their sensitivity and potential impact if compromised.' },
                'INFO-006': { id: 'INFO-006', domainId: 'information', title: 'Security caveats and special handling', description: 'Apply security caveats and special handling instructions as specified by the controlling authority to ensure appropriate protection measures.' },
                'INFO-007': { id: 'INFO-007', domainId: 'information', title: 'Security caveat marking standards', description: 'Security caveats must be marked as text alongside classification markings to clearly indicate special handling or access requirements.' },
                'INFO-008': { id: 'INFO-008', domainId: 'information', title: 'Accountable material numbering', description: 'Accountable material must have appropriate page numbering and reference systems to maintain accountability and traceability.' },
                'INFO-009': { id: 'INFO-009', domainId: 'information', title: 'Handle material under caveat rules', description: 'Accountable material must be handled strictly in accordance with relevant caveat requirements and special handling instructions.' },
                'INFO-010': { id: 'INFO-010', domainId: 'information', title: 'Email marking standards', description: 'Email marking standards must be applied when exchanging information to ensure recipients understand protection requirements and handling obligations.' },
                'INFO-011': { id: 'INFO-011', domainId: 'information', title: 'Recordkeeping metadata for security marking', description: 'Implement recordkeeping metadata standards for security markings on information systems to ensure consistent and automated protection.' },
                'INFO-012': { id: 'INFO-012', domainId: 'information', title: 'Metadata for access restrictions', description: 'Apply appropriate metadata properties to implement and enforce information access restrictions based on security classifications and caveats.' },
                'INFO-013': { id: 'INFO-013', domainId: 'information', title: 'Approved locations for classified discussions', description: 'Security classified discussions and dissemination of security classified information are only conducted in approved locations with appropriate security measures.' },
                'INFO-014': { id: 'INFO-014', domainId: 'information', title: 'Operational controls for information holdings', description: 'Entity implements operational controls for its information holdings that are proportional to their value, importance and sensitivity levels.' },
                'INFO-015': { id: 'INFO-015', domainId: 'information', title: 'Register for TOP SECRET information', description: 'An auditable register is maintained for TOP SECRET information and accountable material to ensure comprehensive tracking and accountability.' },
                'INFO-016': { id: 'INFO-016', domainId: 'information', title: 'Secure disposal of information', description: 'OFFICIAL and security classified information is disposed of securely in accordance with Minimum Protections, ISM, Records Authorities, and Archives Act 1983.' },
                'INFO-017': { id: 'INFO-017', domainId: 'information', title: 'Destruction of classified information', description: 'Security classified information is appropriately destroyed in accordance with Minimum Protections when it reaches retention limits or authorized destruction dates.' },
                'INFO-018': { id: 'INFO-018', domainId: 'information', title: 'Access control for classified information', description: 'Access to security classified information is only provided to people outside the entity with appropriate clearance, need-to-know, and proper transfer protocols.' },
                'INFO-019': { id: 'INFO-019', domainId: 'information', title: 'National MOU for information sharing', description: 'The Memorandum of Understanding between Commonwealth, States and Territories is applied when sharing information with state and territory government agencies.' },
                'INFO-020': { id: 'INFO-020', domainId: 'information', title: 'Agreements for third-party sharing', description: 'Formal agreements establishing handling requirements and protections must be in place before sharing classified information with non-government entities.' },
                'INFO-021': { id: 'INFO-021', domainId: 'information', title: 'International agreement protections', description: 'Provisions concerning security of people, information and resources contained in international agreements and arrangements to which Australia is party must be met.' },
                'INFO-022': { id: 'INFO-022', domainId: 'information', title: 'Foreign entity protections', description: 'Australian Government security classified information shared with foreign entities must be protected by explicit legislative provision, international agreement or arrangement.' },
                'INFO-023': { id: 'INFO-023', domainId: 'information', title: 'Australian Eyes Only (AUSTEO) restrictions', description: 'AUSTEO caveat information is never shared with non-Australian citizens, even under international agreements, unless specific exemption is granted.' },
                'INFO-024': { id: 'INFO-024', domainId: 'information', title: 'Australian Government Access Only (AGAO) caveat', description: 'AGAO caveat information is not shared with non-Australian citizens, except under specific departmental relationships or approved exemptions.' },
                'INFO-025': { id: 'INFO-025', domainId: 'information', title: 'Foreign entity caveat handling', description: 'Where international agreements exist, security classified foreign entity information is safeguarded by the provisions set out in the agreement or arrangement.' },
                'INFO-026': { id: 'INFO-026', domainId: 'information', title: 'Non-government stakeholder protections', description: 'Australian Government classified information shared with foreign non-government stakeholders must be protected by explicit legislative provision, international agreement or arrangement.' },

                // Technology Domain - First 12 Requirements
                'TECH-001': { id: 'TECH-001', domainId: 'technology', title: 'Cyber security throughout technology lifecycle', description: 'Apply comprehensive cyber security principles throughout the entire technology asset lifecycle from procurement to disposal.' },
                'TECH-002': { id: 'TECH-002', domainId: 'technology', title: 'ASD ISM controls and guidelines', description: 'Apply Australian Signals Directorate Information Security Manual (ISM) controls and guidelines on a risk-based approach to ensure appropriate security.' },
                'TECH-003': { id: 'TECH-003', domainId: 'technology', title: 'Technology Asset Stocktake and Risk Management', description: 'Maintain Technology Asset Stocktake and implement Tech Security Risk Management Plan for all internet-facing systems and critical infrastructure.' },
                'TECH-004': { id: 'TECH-004', domainId: 'technology', title: 'Authorise technology systems to operate', description: 'Formally authorise each technology system to operate based on comprehensive risk acceptance and security assessment processes.' },
                'TECH-005': { id: 'TECH-005', domainId: 'technology', title: 'ISM risk-based authorisation decisions', description: 'Base all system authorisation decisions on ISM-compliant risk-based assessments that consider threats, vulnerabilities, and business requirements.' },
                'TECH-006': { id: 'TECH-006', domainId: 'technology', title: 'System authorisation to highest classification', description: 'Each system must be authorised to operate at its highest data classification level with appropriate security controls implemented.' },
                'TECH-007': { id: 'TECH-007', domainId: 'technology', title: 'Register of authorised technology systems', description: 'Maintain a comprehensive register of all authorised technology systems with current security status and authorisation details.' },
                'TECH-008': { id: 'TECH-008', domainId: 'technology', title: 'Reassess system suitability on changes', description: 'Reassess system suitability and security posture whenever significant changes occur to systems, threats, or operating environment.' },
                'TECH-009': { id: 'TECH-009', domainId: 'technology', title: 'TikTok application restrictions', description: 'TikTok application must be blocked on government devices, with strict mitigations applied if access is operationally required.' },
                'TECH-010': { id: 'TECH-010', domainId: 'technology', title: 'Temporary mitigations for legacy IT', description: 'Apply appropriate temporary mitigations for legacy IT systems while transitioning to compliant solutions that meet current security standards.' },
                'TECH-011': { id: 'TECH-011', domainId: 'technology', title: 'Store technology assets in security zones', description: 'Store technology assets in appropriate security zones based on their classification level and operational requirements for protection.' },
                'TECH-012': { id: 'TECH-012', domainId: 'technology', title: 'Top Secret IT asset storage requirements', description: 'Top Secret IT assets must be stored in SCEC or ASIO-prescribed secure racks and compartments with enhanced physical security measures.' },
                'TECH-013': { id: 'TECH-013', domainId: 'technology', title: 'ISM disposal and wipe controls', description: 'Dispose of or wipe government technology assets according to ISM requirements on decommission, destruction, or change of use to prevent data recovery.' },
                'TECH-014': { id: 'TECH-014', domainId: 'technology', title: 'Mandatory patch management', description: 'Apply vendor-issued and ASD-recommended updates and patches within specified timeframes to maintain security posture and address vulnerabilities.' },
                'TECH-015': { id: 'TECH-015', domainId: 'technology', title: 'Minimum Essential Eight Level', description: 'Achieve and maintain Essential Eight Maturity Level 3 on externally-facing and significant systems unless risk accepted by CISO/CSO.' },
                'TECH-016': { id: 'TECH-016', domainId: 'technology', title: 'Daily backup and restore testing', description: 'Perform daily backups and restoration testing for technology assets managing important or critical information to ensure data recovery capabilities.' },
                'TECH-017': { id: 'TECH-017', domainId: 'technology', title: 'DNS filtering on government systems', description: 'Implement DNS filtering controls for government technology devices accessing the internet to block malicious domains and enhance security.' },
                'TECH-018': { id: 'TECH-018', domainId: 'technology', title: 'Cloud provider certification requirement', description: 'Use only ASD-certified cloud and data centre providers for classified and government-significant systems, unless risk accepted by CISO/CSO.' },
                'TECH-019': { id: 'TECH-019', domainId: 'technology', title: 'Cloud Service Provider IRAP assessment', description: 'Obtain ASD IRAP security assessment report for any Cloud Service Provider storing, processing, or transmitting government data.' },
                'TECH-020': { id: 'TECH-020', domainId: 'technology', title: 'Vulnerability Disclosure Program', description: 'Entities must participate in the ASD-coordinated government-wide Vulnerability Disclosure Program for coordinated vulnerability management.' },
                'TECH-021': { id: 'TECH-021', domainId: 'technology', title: 'ASD Cyber Partnership participation', description: 'Mandatory government entity registration and participation in ASD Cyber Partnership Program for vulnerability and threat intelligence sharing.' },
                'TECH-022': { id: 'TECH-022', domainId: 'technology', title: 'Gateways and SSE for digital infrastructure', description: 'Protect digital infrastructure by implementing either ASD-approved Gateways or Security Service Edge solutions for enhanced network security.' },
                'TECH-023': { id: 'TECH-023', domainId: 'technology', title: 'Post-quantum cryptography', description: 'Use only ASD-approved post-quantum cryptographic equipment and software for handling Top Secret data or as directed by ASD for future-proof security.' },
                'TECH-024': { id: 'TECH-024', domainId: 'technology', title: 'Special protection for government-significant systems', description: 'Apply additional ASD-defined cyber protections to technology assets essential to government continuity or national interest with enhanced security measures.' },

                // Personnel Domain - First 12 Requirements
                'PERS-001': { id: 'PERS-001', domainId: 'personnel', title: 'Ensure eligibility and suitability of personnel', description: 'Ensure comprehensive eligibility and suitability assessment of all personnel before granting access to government resources and information.' },
                'PERS-002': { id: 'PERS-002', domainId: 'personnel', title: 'Conduct Level 3 identity checks', description: 'Conduct thorough identity verification checks for all staff meeting Level 3 Assurance standards to confirm identity authenticity.' },
                'PERS-003': { id: 'PERS-003', domainId: 'personnel', title: 'Verify biographic information', description: 'Verify biographic information against original identity documents to ensure accuracy and authenticity of personnel records.' },
                'PERS-004': { id: 'PERS-004', domainId: 'personnel', title: 'Confirm work and government eligibility', description: 'Confirm work eligibility status and Australian Government employment eligibility for all staff before commencement of duties.' },
                'PERS-005': { id: 'PERS-005', domainId: 'personnel', title: 'Personnel compliance agreements', description: 'Obtain written personnel assurance and agreement to comply with relevant security standards and organizational requirements.' },
                'PERS-006': { id: 'PERS-006', domainId: 'personnel', title: 'Temporary access clearance requirements', description: 'Temporary access to TOP SECRET information requires completed security checks and appropriate clearance verification before access is granted.' },
                'PERS-007': { id: 'PERS-007', domainId: 'personnel', title: 'Risk-based temporary access decisions', description: 'Base all temporary access decisions on comprehensive risk assessment considering personnel background, access requirements, and operational needs.' },
                'PERS-008': { id: 'PERS-008', domainId: 'personnel', title: 'Supervised temporary access protocols', description: 'Implement supervised temporary access protocols for classified information and resources to ensure appropriate oversight and control.' },
                'PERS-009': { id: 'PERS-009', domainId: 'personnel', title: 'Time-limited temporary access', description: 'Temporary access must be time-limited to maximum 3 months in most cases with clear justification for any extensions required.' },
                'PERS-010': { id: 'PERS-010', domainId: 'personnel', title: 'Vetting agency clearance confirmation', description: 'Vetting agency must confirm clearance documentation is complete before any provisional access to classified information is granted.' },
                'PERS-011': { id: 'PERS-011', domainId: 'personnel', title: 'Caveated information exceptional access', description: 'Temporary access to caveated information is permitted only in exceptional circumstances with enhanced security measures and oversight.' },
                'PERS-012': { id: 'PERS-012', domainId: 'personnel', title: 'Signed undertakings before access', description: 'Personnel must sign comprehensive undertakings to protect information and resources before any temporary access is granted to classified materials.' },

                // Physical Domain - First 12 Requirements
                'PHYS-001': { id: 'PHYS-001', domainId: 'physical', title: 'Integrate protective security in facility planning', description: 'Integrate comprehensive protective security planning and design considerations into all facility development and modification projects.' },
                'PHYS-002': { id: 'PHYS-002', domainId: 'physical', title: 'Facility security plans for buildings', description: 'Develop detailed facility security plans for all new and significantly modified buildings to ensure appropriate protective measures.' },
                'PHYS-003': { id: 'PHYS-003', domainId: 'physical', title: 'Site location security risk factors', description: 'Consider comprehensive security risk factors in site location decisions including threats, vulnerabilities, and operational requirements.' },
                'PHYS-004': { id: 'PHYS-004', domainId: 'physical', title: 'Risk-commensurate facility access', description: 'Implement secure facility access controls that are commensurate with the assessed security risk and operational requirements.' },
                'PHYS-005': { id: 'PHYS-005', domainId: 'physical', title: 'Construction meets technical standards', description: 'Ensure construction meets established technical notes and standards for public areas, authorized areas, and technology asset protection.' },
                'PHYS-006': { id: 'PHYS-006', domainId: 'physical', title: 'Security Zones 2-5 ASIO compliance', description: 'Security Zones 2-5 must be built according to ASIO Technical Notes specifically designed for protection of classified assets.' },
                'PHYS-007': { id: 'PHYS-007', domainId: 'physical', title: 'Operate facilities per Security Zone requirements', description: 'Operate and maintain all facilities in accordance with their designated Security Zone classification and associated control requirements.' },
                'PHYS-008': { id: 'PHYS-008', domainId: 'physical', title: 'Zones 1-4 certification before use', description: 'Security Zones 1-4 must receive appropriate certification before operational use to ensure compliance with security standards.' },
                'PHYS-009': { id: 'PHYS-009', domainId: 'physical', title: 'Zone 5 ASIO-T4 certification', description: 'Zone 5 facilities for TOP SECRET information must be certified by ASIO-T4 before operational use with enhanced security measures.' },
                'PHYS-010': { id: 'PHYS-010', domainId: 'physical', title: 'Zones 1-5 accreditation requirements', description: 'All Security Zones 1-5 must be formally accredited before use, ensuring correct security controls are implemented and risks accepted.' },
                'PHYS-011': { id: 'PHYS-011', domainId: 'physical', title: 'SCIF areas ASD accreditation', description: 'Sensitive Compartmented Information Facility (SCIF) areas for TOP SECRET information must be accredited by ASD before operational use.' },
                'PHYS-012': { id: 'PHYS-012', domainId: 'physical', title: 'Physical security measures for assets', description: 'Implement comprehensive physical security measures to prevent unauthorized access, use, or removal of all classified and sensitive assets.' }
            };
        }

        setupEventListeners() {
            // Navigation event listeners
            document.getElementById('homeBtn').addEventListener('click', () => {
                this.showView('home');
                this.updateNavButtons('homeBtn');
            });

            document.getElementById('searchBtn').addEventListener('click', () => {
                this.showView('search');
                this.updateNavButtons('searchBtn');
            });

            document.getElementById('progressBtn').addEventListener('click', () => {
                this.showView('progress');
                this.updateNavButtons('progressBtn');
                this.renderProgress();
            });

            document.getElementById('projectBtn').addEventListener('click', () => {
                this.showView('project');
                this.updateNavButtons('projectBtn');
            });

            document.getElementById('dataBtn').addEventListener('click', () => {
                this.showView('data');
                this.updateNavButtons('dataBtn');
                this.updateDataStats();
            });

            document.getElementById('helpBtn').addEventListener('click', () => {
                this.showView('help');
                this.updateNavButtons('helpBtn');
            });

            // Welcome modal
            const closeWelcomeBtn = document.getElementById('closeWelcome');
            if (closeWelcomeBtn) {
                closeWelcomeBtn.addEventListener('click', () => {
                    this.hideWelcomeModal();
                });
            }

            // Data management buttons
            const exportDataBtn = document.getElementById('exportDataBtn');
            if (exportDataBtn) {
                exportDataBtn.addEventListener('click', () => this.exportData());
            }

            const importDataBtn = document.getElementById('importDataBtn');
            const importFileInput = document.getElementById('importFileInput');
            if (importDataBtn && importFileInput) {
                importDataBtn.addEventListener('click', () => importFileInput.click());
                importFileInput.addEventListener('change', (e) => this.importData(e));
            }

            const clearDataBtn = document.getElementById('clearDataBtn');
            if (clearDataBtn) {
                clearDataBtn.addEventListener('click', () => this.clearAllData());
            }

            // Search functionality
            const searchInput = document.getElementById('searchInput');
            const searchSubmit = document.getElementById('searchSubmit');
            
            if (searchInput && searchSubmit) {
                const performSearch = () => {
                    const query = searchInput.value.toLowerCase().trim();
                    if (query) {
                        this.performSearch(query);
                    } else {
                        document.getElementById('searchResults').innerHTML = '<p>Please enter a search term.</p>';
                    }
                };

                searchSubmit.addEventListener('click', performSearch);
                searchInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        performSearch();
                    }
                });
            }

            // Project management
            const addProjectBtn = document.getElementById('addProjectBtn');
            if (addProjectBtn) {
                addProjectBtn.addEventListener('click', () => this.showProjectModal());
            }

            // Back button in project detail view
            const backToProjectsBtn = document.getElementById('backToProjectsBtn');
            if (backToProjectsBtn) {
                backToProjectsBtn.addEventListener('click', () => {
                    const listView = document.getElementById('projectListView');
                    const detailView = document.getElementById('projectDetailView');
                    if (detailView) detailView.classList.add('hidden');
                    if (listView) listView.classList.remove('hidden');
                    this.renderProjects();
                });
            }

            // Modal event listeners
            this.setupModalEventListeners();
        }

        setupModalEventListeners() {
            // Project modal
            const projectForm = document.getElementById('projectForm');
            const cancelProject = document.getElementById('cancelProject');
            
            if (projectForm) {
                projectForm.addEventListener('submit', (e) => this.handleProjectForm(e));
            }
            if (cancelProject) {
                cancelProject.addEventListener('click', () => this.hideModal('projectModal'));
            }

            // Task modal
            const taskForm = document.getElementById('taskForm');
            const cancelTask = document.getElementById('cancelTask');
            
            if (taskForm) {
                taskForm.addEventListener('submit', (e) => this.handleTaskForm(e));
            }
            if (cancelTask) {
                cancelTask.addEventListener('click', () => this.hideModal('taskModal'));
            }

            // Risk modal
            const riskForm = document.getElementById('riskForm');
            const cancelRisk = document.getElementById('cancelRisk');
            
            if (riskForm) {
                riskForm.addEventListener('submit', (e) => this.handleRiskForm(e));
            }
            if (cancelRisk) {
                cancelRisk.addEventListener('click', () => this.hideModal('riskModal'));
            }

            // Incident modal
            const incidentForm = document.getElementById('incidentForm');
            const cancelIncident = document.getElementById('cancelIncident');
            
            if (incidentForm) {
                incidentForm.addEventListener('submit', (e) => this.handleIncidentForm(e));
            }
            if (cancelIncident) {
                cancelIncident.addEventListener('click', () => this.hideModal('incidentModal'));
            }

            // Project view tab switching
            const tabBtns = document.querySelectorAll('.tab-btn');
            tabBtns.forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const tabName = e.target.getAttribute('data-tab');
                    if (tabName) {
                        this.switchProjectTab(tabName);
                    }
                });
            });

            // Add Task button in project view
            const addTaskBtn = document.getElementById('addTaskBtn');
            if (addTaskBtn) {
                addTaskBtn.addEventListener('click', () => {
                    this.showTaskModal(null, this.currentProjectId);
                });
            }

            // Add Risk button in project view
            const addRiskBtn = document.getElementById('addRiskBtn');
            if (addRiskBtn) {
                addRiskBtn.addEventListener('click', () => {
                    this.showRiskModal(null, this.currentProjectId);
                });
            }

            // Link Requirements button in project view
            const linkReqBtn = document.getElementById('linkRequirementBtn');
            if (linkReqBtn) {
                linkReqBtn.addEventListener('click', () => {
                    this.showLinkRequirementsModal();
                });
            }
        }

        showWelcomeModalIfFirstTime() {
            const hasSeenWelcome = localStorage.getItem('pspf_welcome_seen');
            if (!hasSeenWelcome) {
                this.showWelcomeModal();
            }
        }

        showWelcomeModal() {
            const modal = document.getElementById('welcomeModal');
            if (modal) {
                modal.style.display = 'block';
            }
        }

        hideWelcomeModal() {
            const modal = document.getElementById('welcomeModal');
            if (modal) {
                modal.style.display = 'none';
                localStorage.setItem('pspf_welcome_seen', 'true');
            }
        }

        showView(viewName) {
            // Hide all views
            document.querySelectorAll('.view').forEach(view => {
                view.classList.remove('active');
            });

            // Show selected view
            const targetView = document.getElementById(viewName + 'View');
            if (targetView) {
                targetView.classList.add('active');
                this.currentView = viewName;
            }

            // Special handling for home view
            if (viewName === 'home') {
                // Show welcome dashboard and hide requirements section
                const welcomeDashboard = document.getElementById('welcomeDashboard');
                const requirementsSection = document.getElementById('requirementsSection');
                
                if (welcomeDashboard) welcomeDashboard.style.display = 'block';
                if (requirementsSection) {
                    requirementsSection.classList.add('hidden');
                    requirementsSection.style.display = 'none';
                }
                
                this.renderHome();
            }

            // Special handling for project view
            if (viewName === 'project') {
                const listView = document.getElementById('projectListView');
                const detailView = document.getElementById('projectDetailView');
                if (listView) listView.classList.remove('hidden');
                if (detailView) detailView.classList.add('hidden');
                this.renderProjects();
            }
        }

        updateNavButtons(activeId) {
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            const activeBtn = document.getElementById(activeId);
            if (activeBtn) {
                activeBtn.classList.add('active');
            }
        }

        renderHome() {
            this.renderDomainsGrid();
            this.renderDomainSummary();
            this.updateDashboardStats();
            this.updateStats();
        }

        renderDomainsGrid() {
            const domainsGrid = document.getElementById('domainsGrid');
            if (!domainsGrid) return;

            domainsGrid.innerHTML = this.domains.map(domain => {
                const health = this.calculateDomainHealth(domain.id);
                const healthClass = health.status;
                
                return `
                    <div class="domain-card ${healthClass}" data-domain="${domain.id}">
                        <div class="domain-header">
                            <h3>${domain.title}</h3>
                        </div>
                        <div class="domain-stats">
                            <span class="health-text">${health.text}</span>
                        </div>
                        <button class="btn btn-outline domain-btn" onclick="window.pspfExplorer.showDomainRequirements('${domain.id}')">
                            View Requirements
                        </button>
                        <div class="pulse-indicator">
                            <div class="pulse-dot ${healthClass}"></div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        renderDomainSummary() {
            const summaryGrid = document.getElementById('domainSummaryGrid');
            if (!summaryGrid) return;

            summaryGrid.innerHTML = this.domains.map(domain => {
                const health = this.calculateDomainHealth(domain.id);
                const requirementCount = domain.requirements.length;
                
                return `
                    <div class="domain-summary-card" onclick="window.pspfExplorer.showDomainRequirements('${domain.id}')">
                        <div class="domain-summary-title">
                            <span>${domain.title}</span>
                            <div class="pulse-dot ${health.status}" style="width: 8px; height: 8px;"></div>
                        </div>
                        <div class="domain-summary-count">${requirementCount} requirements</div>
                        <div class="domain-summary-desc">${domain.description}</div>
                    </div>
                `;
            }).join('');
        }

        updateDashboardStats() {
            const totalRequirements = this.domains.reduce((sum, domain) => sum + domain.requirements.length, 0);
            const totalProjects = this.projects.length;
            const completedRequirements = this.getCompletedRequirementsCount();
            const complianceRate = totalRequirements > 0 ? Math.round((completedRequirements / totalRequirements) * 100) : 0;

            const totalReqEl = document.getElementById('totalRequirements');
            const totalDomainsEl = document.getElementById('totalDomains');
            const totalProjectsEl = document.getElementById('totalProjects');
            const complianceRateEl = document.getElementById('complianceRate');

            if (totalReqEl) totalReqEl.textContent = totalRequirements;
            if (totalDomainsEl) totalDomainsEl.textContent = this.domains.length;
            if (totalProjectsEl) totalProjectsEl.textContent = totalProjects;
            if (complianceRateEl) complianceRateEl.textContent = `${complianceRate}%`;
        }

        getCompletedRequirementsCount() {
            // Count requirements that are linked to projects as "in progress"
            let completedCount = 0;
            this.domains.forEach(domain => {
                domain.requirements.forEach(reqId => {
                    const linkedProjects = this.projects.filter(project => 
                        project.linkedRequirements && project.linkedRequirements.includes(reqId)
                    );
                    if (linkedProjects.length > 0) {
                        completedCount++;
                    }
                });
            });
            return completedCount;
        }

        showDomainRequirements(domainId) {
            const domain = this.domains.find(d => d.id === domainId);
            if (!domain) return;

            this.selectedDomain = domainId;

            // Hide welcome dashboard and show requirements section
            const welcomeDashboard = document.getElementById('welcomeDashboard');
            const requirementsSection = document.getElementById('requirementsSection');
            
            if (welcomeDashboard) welcomeDashboard.style.display = 'none';
            if (requirementsSection) {
                requirementsSection.classList.remove('hidden');
                requirementsSection.style.display = 'block';
            }
            
            const selectedDomainTitle = document.getElementById('selectedDomainTitle');
            const selectedDomainDescription = document.getElementById('selectedDomainDescription');
            const requirementsList = document.getElementById('requirementsList');

            if (selectedDomainTitle) selectedDomainTitle.textContent = domain.title + ' Requirements';
            if (selectedDomainDescription) selectedDomainDescription.textContent = domain.description;

            if (requirementsList) {
                requirementsList.innerHTML = domain.requirements.map(reqId => {
                    const requirement = this.requirements[reqId];
                    const compliance = this.compliance[reqId] || { status: 'not-set', comment: '', url: '' };
                    
                    return `
                        <div class="requirement-item" data-req="${reqId}" onclick="window.pspfExplorer.showRequirementDetails('${reqId}')">
                            <div class="requirement-info">
                                <span class="requirement-code">${reqId}</span>
                                ${compliance.url ? '<span class="url-indicator" title="Has reference link">üîó</span>' : ''}
                            </div>
                            <span class="requirement-status ${compliance.status}">${this.getStatusText(compliance.status)}</span>
                        </div>
                    `;
                }).join('');
            }

            if (requirementsSection) {
                requirementsSection.classList.remove('hidden');
            }
            
            // Clear the details panel
            this.clearRequirementDetails();
        }

        showRequirementDetails(reqId) {
            const requirement = this.requirements[reqId];
            const compliance = this.compliance[reqId] || { status: 'not-set', comment: '', url: '' };
            const requirementDetails = document.getElementById('requirementDetails');
            
            if (!requirement || !requirementDetails) return;

            // Update active state in sidebar
            document.querySelectorAll('.requirement-item').forEach(item => {
                item.classList.remove('active');
            });
            document.querySelector(`[data-req="${reqId}"]`).classList.add('active');

            // Get linked projects
            const linkedProjects = this.projects.filter(project => 
                Array.isArray(project.requirements) && project.requirements.includes(reqId)
            );

            requirementDetails.innerHTML = `
                <h4>${requirement.title}</h4>
                <p><strong>Requirement ID:</strong> ${reqId}</p>
                <p>${requirement.description}</p>
                
                ${compliance.url ? `
                    <div class="requirement-url-section">
                        <h5>üìé Reference Link</h5>
                        <div class="url-display">
                            <a href="${compliance.url}" target="_blank" rel="noopener noreferrer" class="requirement-link">
                                ${compliance.url}
                                <span class="external-icon">‚Üó</span>
                            </a>
                        </div>
                    </div>
                ` : ''}
                
                <div class="compliance-controls">
                    <h5>Compliance Status</h5>
                    <select class="compliance-select" data-req="${reqId}" onchange="window.pspfExplorer.updateCompliance('${reqId}', this.value)">
                        <option value="not-set" ${compliance.status === 'not-set' ? 'selected' : ''}>Not Set</option>
                        <option value="yes" ${compliance.status === 'yes' ? 'selected' : ''}>Yes</option>
                        <option value="no" ${compliance.status === 'no' ? 'selected' : ''}>No</option>
                        <option value="partial" ${compliance.status === 'partial' ? 'selected' : ''}>Partial</option>
                    </select>
                    
                    <h5>Reference URL</h5>
                    <input type="url" class="compliance-url" data-req="${reqId}" 
                           placeholder="https://example.com/policy-document" 
                           value="${compliance.url || ''}" 
                           onblur="window.pspfExplorer.updateComplianceUrl('${reqId}', this.value)">
                    <small class="field-help">üìé Link to relevant documentation, policies, or evidence</small>
                    
                    <h5>Comments</h5>
                    <textarea class="compliance-comment" data-req="${reqId}" placeholder="Add implementation notes, evidence, or comments..." onblur="window.pspfExplorer.updateComplianceComment('${reqId}', this.value)">${compliance.comment}</textarea>
                </div>
                
                <div class="linked-projects-section">
                    <h5>Linked Projects</h5>
                    <div class="linked-projects-list" id="linkedProjectsList-${reqId}">
                        ${linkedProjects.length > 0 ? 
                            linkedProjects.map(project => `
                                <div class="linked-project-item">
                                    <span class="project-name">${project.name}</span>
                                    <span class="project-status status-${project.status}">${this.getStatusText(project.status)}</span>
                                    <button class="btn-link btn-small" onclick="window.pspfExplorer.unlinkProjectFromRequirement('${project.id}', '${reqId}')">
                                        ‚úï Unlink
                                    </button>
                                </div>
                            `).join('') : 
                            '<p class="no-projects">No projects linked to this requirement.</p>'
                        }
                    </div>
                    <button class="btn btn-primary btn-small" onclick="window.pspfExplorer.showLinkProjectModal('${reqId}')">
                        + Link Project
                    </button>
                </div>
            `;
        }

        clearRequirementDetails() {
            const requirementDetails = document.getElementById('requirementDetails');
            if (requirementDetails) {
                requirementDetails.innerHTML = `
                    <div class="placeholder-content">
                        <h4>Select a Requirement</h4>
                        <p>Choose a requirement from the list to view its details and compliance status.</p>
                    </div>
                `;
            }
        }

        showLinkProjectModal(reqId) {
            const availableProjects = this.projects.filter(project => 
                !Array.isArray(project.requirements) || !project.requirements.includes(reqId)
            );

            if (availableProjects.length === 0) {
                alert('No available projects to link. Create a project first.');
                return;
            }

            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.innerHTML = `
                <div class="modal-content">
                    <h3>Link Project to Requirement</h3>
                    <div class="form-group">
                        <label for="projectSelect">Select Project:</label>
                        <select id="projectSelect" class="form-control">
                            <option value="">Choose a project...</option>
                            ${availableProjects.map(project => `
                                <option value="${project.id}">${project.name} (${this.getStatusText(project.status)})</option>
                            `).join('')}
                        </select>
                    </div>
                    <div class="modal-buttons">
                        <button class="btn btn-secondary" onclick="this.closest('.modal').remove()">Cancel</button>
                        <button class="btn btn-primary" onclick="window.pspfExplorer.linkProjectToRequirement(document.getElementById('projectSelect').value, '${reqId}'); this.closest('.modal').remove();">Link Project</button>
                    </div>
                </div>
            `;

            document.body.appendChild(modal);
            modal.style.display = 'block';
        }

        linkProjectToRequirement(projectId, reqId) {
            if (!projectId || !reqId) return;

            const project = this.projects.find(p => p.id === projectId);
            if (!project) return;

            // Initialize requirements array if it doesn't exist
            if (!Array.isArray(project.requirements)) {
                project.requirements = [];
            }

            // Add requirement if not already linked
            if (!project.requirements.includes(reqId)) {
                project.requirements.push(reqId);
                this.saveData();
                
                // Refresh the requirement details to show the new link
                this.showRequirementDetails(reqId);
                
                // Also refresh project view if it's open
                if (this.currentProjectId === projectId) {
                    this.showProjectDetails(projectId);
                }
            }
        }

        unlinkProjectFromRequirement(projectId, reqId) {
            const project = this.projects.find(p => p.id === projectId);
            if (!project || !Array.isArray(project.requirements)) return;

            // Remove requirement from project
            project.requirements = project.requirements.filter(r => r !== reqId);
            this.saveData();
            
            // Refresh the requirement details to show the change
            this.showRequirementDetails(reqId);
            
            // Also refresh project view if it's open
            if (this.currentProjectId === projectId) {
                this.showProjectDetails(projectId);
            }
        }

        getStatusText(status) {
            switch(status) {
                case 'yes': return 'Met';
                case 'no': return 'Not Met';
                case 'partial': return 'Partial';
                default: return 'Not Set';
            }
        }

        updateCompliance(reqId, status) {
            if (!this.compliance[reqId]) {
                this.compliance[reqId] = {};
            }
            this.compliance[reqId].status = status;
            this.saveData();
            this.renderDomainsGrid();
            this.updateStats();
            
            // Update the sidebar item status
            const sidebarItem = document.querySelector(`[data-req="${reqId}"] .requirement-status`);
            if (sidebarItem) {
                sidebarItem.className = `requirement-status ${status}`;
                sidebarItem.textContent = this.getStatusText(status);
            }
        }

        updateComplianceComment(reqId, comment) {
            if (!this.compliance[reqId]) {
                this.compliance[reqId] = {};
            }
            this.compliance[reqId].comment = comment;
            this.saveData();
        }

        updateComplianceUrl(reqId, url) {
            if (!this.compliance[reqId]) {
                this.compliance[reqId] = {};
            }
            this.compliance[reqId].url = url.trim();
            this.saveData();
            
            // Refresh the requirement details to show/hide URL section
            this.showRequirementDetails(reqId);
        }

        calculateDomainHealth(domainId) {
            const domain = this.domains.find(d => d.id === domainId);
            if (!domain) return { status: 'critical', met: 0, total: 0, text: 'Unknown' };

            const requirements = domain.requirements;
            let totalRequirements = requirements.length;
            let metRequirements = 0;
            let partialRequirements = 0;
            let unmetWithGoodExplanations = 0;

            requirements.forEach(reqId => {
                const compliance = this.compliance[reqId];
                if (compliance) {
                    if (compliance.status === 'yes') {
                        metRequirements++;
                    } else if (compliance.status === 'partial') {
                        partialRequirements++;
                    } else if (compliance.status === 'no' && compliance.comment && compliance.comment.trim().length > 10) {
                        unmetWithGoodExplanations++;
                    }
                }
            });

            if (metRequirements === totalRequirements) {
                return { status: 'healthy', met: metRequirements, total: totalRequirements, text: 'Excellent' };
            } else if (metRequirements + partialRequirements + unmetWithGoodExplanations >= totalRequirements * 0.8) {
                return { status: 'warning', met: metRequirements, total: totalRequirements, text: 'Good' };
            } else {
                return { status: 'critical', met: metRequirements, total: totalRequirements, text: 'Needs Attention' };
            }
        }

        updateStats() {
            let totalRequirements = 0;
            let metRequirements = 0;

            this.domains.forEach(domain => {
                domain.requirements.forEach(reqId => {
                    totalRequirements++;
                    const compliance = this.compliance[reqId];
                    if (compliance && compliance.status === 'yes') {
                        metRequirements++;
                    }
                });
            });

            const compliancePercentage = totalRequirements > 0 ? Math.round((metRequirements / totalRequirements) * 100) : 0;

            const totalProjects = this.projects.length;
            const totalTasks = this.tasks.length;
            const completedTasks = this.tasks.filter(t => t.status === 'completed').length;
            const totalRisks = this.risks.length;
            const taskCompletionPercentage = totalTasks > 0 ? Math.round((completedTasks / totalTasks) * 100) : 0;

            // Animate number updates
            this.animateNumber('totalProjects', totalProjects);
            this.animateNumber('totalTasks', totalTasks);
            this.animateNumber('completedTasks', completedTasks);
            this.animateNumber('totalRisks', totalRisks);
            
            // Update main compliance display
            document.getElementById('overallCompliance').textContent = compliancePercentage + '%';
            
            // Update progress rings
            this.updateProgressRing('taskCompletionRing', 'taskCompletionPercent', taskCompletionPercentage);
            this.updateProgressRing('complianceRing', 'compliancePercent', compliancePercentage);
            
            // Update mini charts
            this.updateMiniChart('projectsChart', Math.min(totalProjects * 10, 100));
            this.updateMiniChart('tasksChart', Math.min(totalTasks * 5, 100));
            this.updateMiniChart('risksChart', Math.min(totalRisks * 15, 100));
            
            // Update trend indicators
            this.updateTrendIndicators(totalProjects, totalTasks, completedTasks, compliancePercentage, totalRisks);
        }
        
        animateNumber(elementId, targetValue) {
            const element = document.getElementById(elementId);
            if (!element) return;
            
            const startValue = parseInt(element.textContent) || 0;
            const duration = 1000;
            const startTime = performance.now();
            
            const animate = (currentTime) => {
                const elapsed = currentTime - startTime;
                const progress = Math.min(elapsed / duration, 1);
                const currentValue = Math.round(startValue + (targetValue - startValue) * progress);
                
                element.textContent = currentValue;
                
                if (progress < 1) {
                    requestAnimationFrame(animate);
                }
            };
            
            requestAnimationFrame(animate);
        }
        
        updateProgressRing(ringId, textId, percentage) {
            const ring = document.getElementById(ringId);
            const text = document.getElementById(textId);
            if (!ring || !text) return;
            
            const circle = ring.querySelector('.progress-ring-progress');
            const radius = 26;
            const circumference = 2 * Math.PI * radius;
            const offset = circumference - (percentage / 100) * circumference;
            
            circle.style.strokeDashoffset = offset;
            text.textContent = percentage + '%';
            
            // Color based on percentage
            if (percentage >= 80) {
                circle.style.stroke = 'var(--success-color)';
            } else if (percentage >= 60) {
                circle.style.stroke = 'var(--warning-color)';
            } else {
                circle.style.stroke = 'var(--danger-color)';
            }
        }
        
        updateMiniChart(chartId, percentage) {
            const chart = document.getElementById(chartId);
            if (!chart) return;
            
            setTimeout(() => {
                chart.style.width = percentage + '%';
            }, 300);
        }
        
        updateTrendIndicators(projects, tasks, completed, compliance, risks) {
            // Simple trend logic - in a real app, you'd compare with historical data
            const trends = {
                projects: projects > 0 ? 'up' : 'neutral',
                tasks: tasks > 0 ? 'up' : 'neutral', 
                completion: completed > 0 ? 'up' : 'neutral',
                compliance: compliance > 50 ? 'up' : compliance > 0 ? 'neutral' : 'down',
                risks: risks > 0 ? 'down' : 'neutral' // More risks = negative trend
            };
            
            this.setTrend('projectsTrend', trends.projects, 'Active projects');
            this.setTrend('tasksTrend', trends.tasks, 'Total tasks');
            this.setTrend('completionTrend', trends.completion, 'Task completion');
            this.setTrend('complianceTrend', trends.compliance, 'Compliance level');
            this.setTrend('risksTrend', trends.risks, 'Risk level');
        }
        
        setTrend(elementId, trend, label) {
            const element = document.getElementById(elementId);
            if (!element) return;
            
            element.className = `stat-trend trend-${trend}`;
            
            const icons = { up: '‚Üó', down: '‚Üò', neutral: '‚Üí' };
            const texts = { 
                up: `${label} improving`, 
                down: `${label} declining`, 
                neutral: `${label} stable` 
            };
            
            element.innerHTML = `<span>${icons[trend]}</span> ${texts[trend]}`;
        }

        renderProgress() {
            const progressGrid = document.getElementById('progressGrid');
            if (!progressGrid) return;

            progressGrid.innerHTML = this.domains.map((domain) => {
                const health = this.calculateDomainHealth(domain.id);
                const requirements = domain.requirements;
                const completedRequirements = requirements.filter(reqId => 
                    this.compliance[reqId] && this.compliance[reqId].status === 'yes'
                ).length;
                const percentage = Math.round((completedRequirements / requirements.length) * 100);

                return `
                    <div class="progress-card ${health.status}">
                        <div class="progress-header">
                            <h3>${domain.title}</h3>
                            <div class="pulse-dot ${health.status}"></div>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${percentage}%"></div>
                        </div>
                        <div class="progress-stats">
                            <span>${completedRequirements}/${requirements.length} completed</span>
                            <span>${percentage}%</span>
                        </div>
                        <p class="progress-status">${health.text}</p>
                        <button class="btn btn-outline btn-small" onclick="window.pspfExplorer.showDomainRequirements('${domain.id}'); window.pspfExplorer.showView('home'); window.pspfExplorer.updateNavButtons('homeBtn');">
                            Manage Compliance
                        </button>
                    </div>
                `;
            }).join('');
        }

        performSearch(query) {
            const results = [];
            const searchResults = document.getElementById('searchResults');
            const spinner = document.getElementById('searchSpinner');

            if (spinner) spinner.style.display = 'block';
            if (searchResults) searchResults.innerHTML = '';

            // Search projects
            this.projects.forEach(project => {
                if (project.name.toLowerCase().includes(query) || 
                    project.description.toLowerCase().includes(query)) {
                    results.push({
                        type: 'Project',
                        title: project.name,
                        description: project.description,
                        id: project.id
                    });
                }
            });

            // Search tasks
            this.tasks.forEach(task => {
                if (task.name.toLowerCase().includes(query) || 
                    task.description.toLowerCase().includes(query)) {
                    results.push({
                        type: 'Task',
                        title: task.name,
                        description: task.description,
                        id: task.id
                    });
                }
            });

            // Search risks
            this.risks.forEach(risk => {
                if (risk.name.toLowerCase().includes(query) || 
                    risk.description.toLowerCase().includes(query) ||
                    risk.mitigation.toLowerCase().includes(query)) {
                    results.push({
                        type: 'Risk',
                        title: risk.name,
                        description: risk.description,
                        severity: risk.severity,
                        id: risk.id
                    });
                }
            });

            // Search requirements
            Object.values(this.requirements).forEach(requirement => {
                if (requirement.title.toLowerCase().includes(query) || 
                    requirement.description.toLowerCase().includes(query)) {
                    const domain = this.domains.find(d => d.id === requirement.domainId);
                    results.push({
                        type: 'Requirement',
                        title: requirement.title,
                        description: requirement.description,
                        domain: domain ? domain.title : 'Unknown'
                    });
                }
            });

            if (results.length === 0) {
                if (spinner) spinner.style.display = 'none';
                searchResults.innerHTML = '<p>No results found for your search.</p>';
                return;
            }

            searchResults.innerHTML = `
                <h3>Search Results (${results.length})</h3>
                <div class="search-results-list">
                    ${results.map(result => `
                        <div class="search-result-item">
                            <span class="result-type ${result.type.toLowerCase()}">${result.type}</span>
                            <h4>${result.title}</h4>
                            <p>${result.description}</p>
                            ${result.domain ? `<span class="result-domain">Domain: ${result.domain}</span>` : ''}
                            ${result.severity ? `<span class="result-severity severity-${result.severity}">Risk Level: ${result.severity.toUpperCase()}</span>` : ''}
                        </div>
                    `).join('')}
                </div>
            `;
            if (spinner) spinner.style.display = 'none';
        }

        // Project Management
        renderProjects() {
            const projectsList = document.getElementById('projectsList');
            if (!projectsList) return;

            if (this.projects.length === 0) {
                projectsList.innerHTML = `
                    <div class="empty-state">
                        <h3>No projects yet</h3>
                        <p>Create your first project to start tracking compliance work.</p>
                    </div>
                `;
                return;
            }

            projectsList.innerHTML = this.projects.map(project => `
                <div class="project-item" data-project="${project.id}" onclick="window.pspfExplorer.showProjectDetails('${project.id}')">
                    <div class="project-name">${project.name}</div>
                    <div class="project-meta">
                        <span class="project-status ${project.status}">${this.getStatusText(project.status)}</span>
                        <span>${this.getProjectTasksCount(project.id)} tasks</span>
                    </div>
                </div>
            `).join('');
            
            // Clear the details panel
            this.clearProjectDetails();
        }

        showProjectDetails(projectId) {
            const project = this.projects.find(p => p.id === projectId);
            const projectDetails = document.getElementById('projectDetails');
            
            if (!project || !projectDetails) return;

            // Update active state in sidebar
            document.querySelectorAll('.project-item').forEach(item => {
                item.classList.remove('active');
            });
            document.querySelector(`[data-project="${projectId}"]`).classList.add('active');

            const tasksCount = this.getProjectTasksCount(projectId);
            const risksCount = this.getProjectRisksCount(projectId);
            const requirementsCount = this.getProjectRequirementsCount(projectId);

            projectDetails.innerHTML = `
                <h4>${project.name}</h4>
                <p><strong>Description:</strong> ${project.description || 'No description provided'}</p>
                
                <div class="project-detail-meta">
                    <div class="project-detail-meta-item">
                        <div class="project-detail-meta-label">Status</div>
                        <div class="project-detail-meta-value">
                            <span class="project-status ${project.status}">${this.getStatusText(project.status)}</span>
                        </div>
                    </div>
                    <div class="project-detail-meta-item">
                        <div class="project-detail-meta-label">Created</div>
                        <div class="project-detail-meta-value">${project.createdAt ? new Date(project.createdAt).toLocaleDateString() : 'Unknown'}</div>
                    </div>
                    <div class="project-detail-meta-item">
                        <div class="project-detail-meta-label">Tasks</div>
                        <div class="project-detail-meta-value">${tasksCount}</div>
                    </div>
                    <div class="project-detail-meta-item">
                        <div class="project-detail-meta-label">Risks</div>
                        <div class="project-detail-meta-value">${risksCount}</div>
                    </div>
                    <div class="project-detail-meta-item">
                        <div class="project-detail-meta-label">Requirements</div>
                        <div class="project-detail-meta-value">${requirementsCount}</div>
                    </div>
                </div>

                <div class="project-actions">
                    <button class="btn btn-primary" onclick="window.pspfExplorer.showProjectModal('${project.id}')">Edit Project</button>
                    <button class="btn btn-secondary" onclick="window.pspfExplorer.addTask('${project.id}')">Add Task</button>
                    <button class="btn btn-outline" onclick="window.pspfExplorer.addRisk('${project.id}')">Add Risk</button>
                    <button class="btn btn-danger" onclick="window.pspfExplorer.deleteProject('${project.id}')">Delete Project</button>
                </div>
            `;
        }

        clearProjectDetails() {
            const projectDetails = document.getElementById('projectDetails');
            if (projectDetails) {
                projectDetails.innerHTML = `
                    <div class="placeholder-content">
                        <h4>Select a Project</h4>
                        <p>Choose a project from the list to view its details and manage tasks.</p>
                    </div>
                `;
            }
        }

        getProjectTasksCount(projectId) {
            return this.tasks.filter(task => task.projectId === projectId).length;
        }

        getProjectRisksCount(projectId) {
            return this.risks.filter(risk => risk.projectId === projectId).length;
        }

        getProjectRequirementsCount(projectId) {
            const project = this.projects.find(p => p.id === projectId);
            return (project && project.requirements) ? project.requirements.length : 0;
        }

        addTask(projectId) {
            this.currentProjectId = projectId;
            this.showTaskModal();
        }

        addRisk(projectId) {
            this.currentProjectId = projectId;
            this.showRiskModal();
        }

        showProjectModal(projectId = null) {
            this.editingProject = projectId;
            const modal = document.getElementById('projectModal');
            const title = document.getElementById('projectModalTitle');
            const form = document.getElementById('projectForm');

            if (projectId) {
                const project = this.projects.find(p => p.id === projectId);
                if (project) {
                    // Ensure requirements array exists on legacy records
                    if (!Array.isArray(project.requirements)) project.requirements = [];
                    title.textContent = 'Edit Project';
                    document.getElementById('projectName').value = project.name;
                    document.getElementById('projectDesc').value = project.description;
                    document.getElementById('projectStatusSelect').value = project.status;
                }
            } else {
                title.textContent = 'Add Project';
                form.reset();
            }

            modal.style.display = 'block';
        }

        handleProjectForm(e) {
            e.preventDefault();
            
            const projectData = {
                name: document.getElementById('projectName').value,
                description: document.getElementById('projectDesc').value,
                status: document.getElementById('projectStatusSelect').value,
                createdAt: new Date().toISOString()
            };

            if (this.editingProject) {
                const index = this.projects.findIndex(p => p.id === this.editingProject);
                if (index !== -1) {
                    this.projects[index] = { ...this.projects[index], ...projectData, requirements: this.projects[index].requirements || [] };
                }
            } else {
                projectData.id = Date.now().toString();
                this.projects.push({ ...projectData, requirements: [] });
            }

            this.saveData();
            this.hideModal('projectModal');
            this.renderProjects();
            this.updateStats();
            this.updateDataStats();
        }

        deleteProject(projectId) {
            if (confirm('Are you sure you want to delete this project? This action cannot be undone.')) {
                this.projects = this.projects.filter(p => p.id !== projectId);
                // Also delete associated tasks
                this.tasks = this.tasks.filter(t => t.projectId !== projectId);
                this.saveData();
                this.renderProjects();
                this.clearProjectDetails();
                this.updateStats();
                this.updateDataStats();
            }
        }

        showProjectTasks(projectId) {
            const project = this.projects.find(p => p.id === projectId);
            if (!project) return;

            // Ensure requirements array exists (migration for legacy data)
            if (!Array.isArray(project.requirements)) {
                project.requirements = [];
                this.saveData();
            }

            this.currentProjectId = projectId;
            this.showView('project');
            this.updateNavButtons('projectBtn');

            // Toggle list/detail panes
            const listView = document.getElementById('projectListView');
            const detailView = document.getElementById('projectDetailView');
            if (listView) listView.classList.add('hidden');
            if (detailView) detailView.classList.remove('hidden');

            // Update project view header
            document.getElementById('projectTitle').textContent = project.name;
            document.getElementById('projectDescription').textContent = project.description;
            // Status chip
            const statusChip = document.getElementById('projectStatusChip');
            if (statusChip) {
                statusChip.textContent = project.status?.replace('-', ' ') || 'Unknown';
                statusChip.className = `status-badge ${project.status || ''}`;
            }
            // Due chip
            const dueChip = document.getElementById('projectDueChip');
            if (dueChip) {
                if (project.endDate) {
                    const end = new Date(project.endDate);
                    const now = new Date();
                    const days = Math.ceil((end - now) / (1000 * 60 * 60 * 24));
                    let cls = 'ok';
                    let label = '';
                    if (days < 0) { cls = 'overdue'; label = `Overdue by ${Math.abs(days)}d`; }
                    else if (days <= 7) { cls = 'soon'; label = `Due in ${days}d`; }
                    else { label = `Due in ${days}d`; }
                    dueChip.textContent = label;
                    dueChip.className = `due-chip ${cls}`;
                } else {
                    dueChip.className = 'due-chip hidden';
                }
            }
            // Compact progress based on tasks in this project
            const projectTasks = this.tasks.filter(t => t.projectId === projectId);
            const completed = projectTasks.filter(t => t.status === 'completed').length;
            const percent = projectTasks.length ? Math.round((completed / projectTasks.length) * 100) : 0;
            const progressFill = document.getElementById('projectProgressFill');
            const progressText = document.getElementById('projectProgressText');
            if (progressFill) progressFill.style.width = `${percent}%`;
            if (progressText) progressText.textContent = `${percent}% complete`;

            // Header quick actions
            const headerAddTaskBtn = document.getElementById('headerAddTaskBtn');
            if (headerAddTaskBtn) headerAddTaskBtn.onclick = () => this.showTaskModal(null, this.currentProjectId);
            const headerAddRiskBtn = document.getElementById('headerAddRiskBtn');
            if (headerAddRiskBtn) headerAddRiskBtn.onclick = () => this.showRiskModal(null, this.currentProjectId);
            const headerExportBtn = document.getElementById('headerExportBtn');
            if (headerExportBtn) headerExportBtn.onclick = () => this.exportData();

            // Set up breadcrumb
            this.updateBreadcrumb([
                { text: 'PSPF Domains', level: 'home' },
                { text: 'Projects', level: 'projects' },
                { text: project.name, level: 'project' }
            ]);

            // Show tasks tab by default and render tasks
            this.switchProjectTab('tasks');
            this.renderTasks(projectId);
            this.updateProjectTabCounts();
            this.renderProjectRequirements();
        }

        updateProjectTabCounts() {
            const tasksCountEl = document.getElementById('tasksCount');
            const risksCountEl = document.getElementById('risksCount');
            const incidentsCountEl = document.getElementById('incidentsCount');
            const reqCountEl = document.getElementById('requirementsCount');
            const pid = this.currentProjectId;
            if (tasksCountEl) tasksCountEl.textContent = this.tasks.filter(t => t.projectId === pid).length;
            if (risksCountEl) risksCountEl.textContent = this.risks.filter(r => r.projectId === pid).length;
            if (incidentsCountEl) incidentsCountEl.textContent = this.incidents.filter(i => i.projectId === pid).length;
            const project = this.projects.find(p => p.id === pid);
            if (reqCountEl) reqCountEl.textContent = project && Array.isArray(project.requirements) ? project.requirements.length : 0;
        }

        // Modal Management
        hideModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.style.display = 'none';
            }
            this.editingProject = null;
            this.editingTask = null;
            this.editingRisk = null;
            this.editingIncident = null;
        }

        // Task Management CRUD Operations
        showTaskModal(taskId = null, projectId = null) {
            this.editingTask = taskId;
            this.currentProjectId = projectId;
            const modal = document.getElementById('taskModal');
            const title = document.getElementById('taskModalTitle');
            const form = document.getElementById('taskForm');

            if (taskId) {
                const task = this.tasks.find(t => t.id === taskId);
                if (task) {
                    title.textContent = 'Edit Task';
                    document.getElementById('taskName').value = task.name;
                    document.getElementById('taskDesc').value = task.description;
                    document.getElementById('taskStatus').value = task.status;
                    document.getElementById('taskAssignee').value = task.assignee || '';
                    document.getElementById('taskDueDate').value = task.dueDate || '';
                }
            } else {
                title.textContent = 'Add Task';
                form.reset();
            }

            modal.style.display = 'block';
        }

        handleTaskForm(e) {
            e.preventDefault();
            this.saveTask();
        }

        saveTask() {
            const taskData = {
                name: document.getElementById('taskName').value,
                description: document.getElementById('taskDesc').value,
                status: document.getElementById('taskStatus').value,
                assignee: document.getElementById('taskAssignee').value,
                dueDate: document.getElementById('taskDueDate').value,
                projectId: this.currentProjectId,
                createdAt: new Date().toISOString()
            };

            if (this.editingTask) {
                const index = this.tasks.findIndex(t => t.id === this.editingTask);
                if (index !== -1) {
                    this.tasks[index] = { ...this.tasks[index], ...taskData };
                }
            } else {
                taskData.id = Date.now().toString();
                this.tasks.push(taskData);
            }

            this.saveData();
            this.hideModal('taskModal');
            this.renderTasks();
            this.updateStats();
            this.updateDataStats();
            this.updateProjectTabCounts();
        }

        editTask(taskId) {
            const task = this.tasks.find(t => t.id === taskId);
            if (task) {
                this.showTaskModal(taskId, task.projectId);
            }
        }

        deleteTask(taskId) {
            if (confirm('Are you sure you want to delete this task? This action cannot be undone.')) {
                this.tasks = this.tasks.filter(t => t.id !== taskId);
                this.saveData();
                this.renderTasks();
                this.updateStats();
                this.updateDataStats();
            }
        }

        renderTasks(projectId = null) {
            const tasksList = document.getElementById('tasksList');
            if (!tasksList) return;

            let tasksToShow = this.tasks;
            if (projectId) {
                tasksToShow = this.tasks.filter(t => t.projectId === projectId);
            }

            if (tasksToShow.length === 0) {
                tasksList.innerHTML = `
                    <div class="empty-state">
                        <h3>No tasks yet</h3>
                        <p>Create your first task to start tracking work.</p>
                    </div>
                `;
                return;
            }

            tasksList.innerHTML = tasksToShow.map(task => {
                const dueDate = task.dueDate ? new Date(task.dueDate) : null;
                const isOverdue = dueDate && dueDate < new Date() && task.status !== 'completed';
                const dueDateClass = isOverdue ? 'overdue' : '';

                return `
                    <div class="task-card ${task.status}">
                        <div class="task-header">
                            <h4>${task.name}</h4>
                            <span class="status-badge ${task.status}">${task.status.replace('-', ' ')}</span>
                        </div>
                        <p class="task-description">${task.description}</p>
                        <div class="task-meta">
                            ${task.assignee ? `<span class="assignee">üë§ ${task.assignee}</span>` : ''}
                            ${task.dueDate ? `<span class="due-date ${dueDateClass}">üìÖ Due: ${new Date(task.dueDate).toLocaleDateString()}</span>` : ''}
                            ${isOverdue ? '<span class="overdue-indicator">‚ö†Ô∏è Overdue</span>' : ''}
                        </div>
                        <div class="task-actions">
                            <button class="btn btn-outline btn-small" onclick="window.pspfExplorer.editTask('${task.id}')">Edit</button>
                            <button class="btn btn-danger btn-small" onclick="window.pspfExplorer.deleteTask('${task.id}')">Delete</button>
                            ${task.status !== 'completed' ? 
                                `<button class="btn btn-success btn-small" onclick="window.pspfExplorer.markTaskComplete('${task.id}')">Complete</button>` : 
                                `<button class="btn btn-secondary btn-small" onclick="window.pspfExplorer.markTaskIncomplete('${task.id}')">Reopen</button>`
                            }
                        </div>
                    </div>
                `;
            }).join('');
        }

        markTaskComplete(taskId) {
            const task = this.tasks.find(t => t.id === taskId);
            if (task) {
                task.status = 'completed';
                task.completedAt = new Date().toISOString();
                this.saveData();
                this.renderTasks();
                this.updateStats();
                this.updateProjectTabCounts();
            }
        }

        markTaskIncomplete(taskId) {
            const task = this.tasks.find(t => t.id === taskId);
            if (task) {
                task.status = 'in-progress';
                delete task.completedAt;
                this.saveData();
                this.renderTasks();
                this.updateStats();
                this.updateProjectTabCounts();
            }
        }

        // Risk Management CRUD Operations
        showRiskModal(riskId = null, projectId = null) {
            this.editingRisk = riskId;
            this.currentProjectId = projectId;
            const modal = document.getElementById('riskModal');
            const title = document.getElementById('riskModalTitle');
            const form = document.getElementById('riskForm');

            if (riskId) {
                const risk = this.risks.find(r => r.id === riskId);
                if (risk) {
                    title.textContent = 'Edit Risk';
                    document.getElementById('riskName').value = risk.name;
                    document.getElementById('riskDesc').value = risk.description;
                    document.getElementById('riskLikelihood').value = risk.likelihood;
                    document.getElementById('riskImpact').value = risk.impact;
                    document.getElementById('riskMitigation').value = risk.mitigation || '';
                }
            } else {
                title.textContent = 'Add Risk';
                form.reset();
            }

            modal.style.display = 'block';
        }

        handleRiskForm(e) {
            e.preventDefault();
            this.saveRisk();
        }

        saveRisk() {
            const likelihood = document.getElementById('riskLikelihood').value;
            const impact = document.getElementById('riskImpact').value;
            const severity = this.calculateRiskSeverity(likelihood, impact);

            const riskData = {
                name: document.getElementById('riskName').value,
                description: document.getElementById('riskDesc').value,
                likelihood: likelihood,
                impact: impact,
                severity: severity,
                mitigation: document.getElementById('riskMitigation').value,
                projectId: this.currentProjectId,
                createdAt: new Date().toISOString()
            };

            if (this.editingRisk) {
                const index = this.risks.findIndex(r => r.id === this.editingRisk);
                if (index !== -1) {
                    this.risks[index] = { ...this.risks[index], ...riskData };
                }
            } else {
                riskData.id = Date.now().toString();
                this.risks.push(riskData);
            }

            this.saveData();
            this.hideModal('riskModal');
            this.renderRisks();
            this.updateDataStats();
            this.updateProjectTabCounts();
        }

        calculateRiskSeverity(likelihood, impact) {
            const values = {
                'very-low': 1,
                'low': 2,
                'medium': 3,
                'high': 4,
                'very-high': 5
            };

            const likelihoodValue = values[likelihood] || 1;
            const impactValue = values[impact] || 1;
            const score = likelihoodValue * impactValue;

            if (score <= 4) return 'low';
            if (score <= 10) return 'medium';
            if (score <= 16) return 'high';
            return 'critical';
        }

        editRisk(riskId) {
            const risk = this.risks.find(r => r.id === riskId);
            if (risk) {
                this.showRiskModal(riskId, risk.projectId);
            }
        }

        deleteRisk(riskId) {
            if (confirm('Are you sure you want to delete this risk? This action cannot be undone.')) {
                this.risks = this.risks.filter(r => r.id !== riskId);
                this.saveData();
                this.renderRisks();
                this.updateDataStats();
                this.updateProjectTabCounts();
            }
        }

        renderRisks(projectId = null) {
            const risksList = document.getElementById('risksList');
            if (!risksList) return;

            let risksToShow = this.risks;
            if (projectId) {
                risksToShow = this.risks.filter(r => r.projectId === projectId);
            }

            if (risksToShow.length === 0) {
                risksList.innerHTML = `
                    <div class="empty-state">
                        <h3>No risks identified</h3>
                        <p>Add risks to track and manage potential issues.</p>
                    </div>
                `;
                return;
            }

            risksList.innerHTML = risksToShow.map(risk => {
                const severityIcon = this.getRiskSeverityIcon(risk.severity);
                const severityClass = `severity-${risk.severity}`;

                return `
                    <div class="risk-card ${severityClass}">
                        <div class="risk-header">
                            <h4>${risk.name}</h4>
                            <div class="risk-severity">
                                <span class="severity-badge ${risk.severity}">${severityIcon} ${risk.severity.toUpperCase()}</span>
                            </div>
                        </div>
                        <p class="risk-description">${risk.description}</p>
                        <div class="risk-matrix">
                            <div class="risk-factor">
                                <span class="factor-label">Likelihood:</span>
                                <span class="factor-value ${risk.likelihood}">${risk.likelihood.replace('-', ' ')}</span>
                            </div>
                            <div class="risk-factor">
                                <span class="factor-label">Impact:</span>
                                <span class="factor-value ${risk.impact}">${risk.impact.replace('-', ' ')}</span>
                            </div>
                        </div>
                        ${risk.mitigation ? `
                            <div class="risk-mitigation">
                                <strong>Mitigation Strategy:</strong>
                                <p>${risk.mitigation}</p>
                            </div>
                        ` : ''}
                        <div class="risk-actions">
                            <button class="btn btn-outline btn-small" onclick="window.pspfExplorer.editRisk('${risk.id}')">Edit</button>
                            <button class="btn btn-danger btn-small" onclick="window.pspfExplorer.deleteRisk('${risk.id}')">Delete</button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        getRiskSeverityIcon(severity) {
            const icons = {
                'low': 'üü¢',
                'medium': 'üü°',
                'high': 'üü†',
                'critical': 'üî¥'
            };
            return icons[severity] || '‚ö™';
        }

        // Placeholder methods for Incident CRUD operations
        handleIncidentForm(e) {
            e.preventDefault();
            this.hideModal('incidentModal');
        }

        switchProjectTab(tabName) {
            // Remove active class from all tab buttons and panes
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.tab-pane').forEach(pane => pane.classList.remove('active'));

            // Add active class to selected tab button and pane
            const activeBtn = document.querySelector(`[data-tab="${tabName}"]`);
            const activePane = document.getElementById(`${tabName}Tab`);

            if (activeBtn) activeBtn.classList.add('active');
            if (activePane) activePane.classList.add('active');

            // Render content based on tab
            switch (tabName) {
                case 'tasks':
                    this.renderTasks(this.currentProjectId);
                    this.updateProjectTabCounts();
                    break;
                case 'risks':
                    this.renderRisks(this.currentProjectId);
                    this.updateProjectTabCounts();
                    break;
                case 'requirements':
                    this.renderProjectRequirements();
                    this.updateProjectTabCounts();
                    break;
                case 'incidents':
                    // TODO: Implement incident rendering
                    this.updateProjectTabCounts();
                    break;
            }
        }

        updateBreadcrumb(items) {
            const breadcrumb = document.getElementById('breadcrumb');
            if (!breadcrumb) return;

            breadcrumb.innerHTML = items.map((item, index) => {
                const isLast = index === items.length - 1;
                return isLast ? 
                    `<span class="current">${item.text}</span>` :
                    `<a href="#" data-level="${item.level}">${item.text}</a>`;
            }).join(' / ');
        }

        // Data Management
        updateDataStats() {
            const projectCount = this.projects.length;
            const taskCount = this.tasks.length;
            const riskCount = this.risks.length;
            const incidentCount = this.incidents.length;
            const lastModified = localStorage.getItem('pspf_last_modified');

            document.getElementById('dataProjectCount').textContent = projectCount;
            document.getElementById('dataTaskCount').textContent = taskCount;
            document.getElementById('dataRiskCount').textContent = riskCount;
            document.getElementById('dataIncidentCount').textContent = incidentCount;
            document.getElementById('dataLastModified').textContent = 
                lastModified ? new Date(lastModified).toLocaleDateString() : 'Never';
        }

        // Requirements linking
        renderProjectRequirements() {
            const list = document.getElementById('requirementsList');
            if (!list) return;
            const project = this.projects.find(p => p.id === this.currentProjectId);
            if (!project) return;
            const linked = Array.isArray(project.requirements) ? project.requirements : [];

            if (linked.length === 0) {
                list.innerHTML = `
                    <div class="empty-state">
                        <h3>No Requirements Linked</h3>
                        <p>Link PSPF requirements that this project addresses.</p>
                    </div>
                `;
                return;
            }

            const items = linked.map(reqId => {
                const req = this.requirements[reqId];
                const domain = req ? this.domains.find(d => d.id === req.domainId) : null;
                const title = req ? req.title : reqId;
                const domainTitle = domain ? domain.title : 'Unknown domain';
                return `
                    <div class="requirement-item" style="background: var(--bg-card); border: 1px solid var(--border-light); border-radius: 8px; padding: 12px; margin-bottom: 8px; display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <div style="font-weight:600; color: var(--text-primary);">${title}</div>
                            <div style="font-size: 0.9rem; color: var(--text-secondary);">${reqId} ‚Ä¢ ${domainTitle}</div>
                        </div>
                        <div>
                            <button class="btn btn-outline btn-small" onclick="window.pspfExplorer.unlinkRequirementFromProject('${reqId}')">Unlink</button>
                        </div>
                    </div>
                `;
            }).join('');

            list.innerHTML = items;
        }

        showLinkRequirementsModal() {
            const modal = document.getElementById('linkRequirementsModal');
            const checklist = document.getElementById('requirementsChecklist');
            const searchInput = document.getElementById('requirementsSearch');
            if (!modal || !checklist) return;

            const project = this.projects.find(p => p.id === this.currentProjectId);
            const selected = new Set(project?.requirements || []);

            const renderChecklist = (filter = '') => {
                const f = filter.toLowerCase();
                const groups = this.domains.map(domain => {
                    const reqs = domain.requirements
                        .map(id => this.requirements[id])
                        .filter(r => r && (r.id.toLowerCase().includes(f) || r.title.toLowerCase().includes(f)));
                    if (reqs.length === 0) return '';
                    const items = reqs.map(r => `
                        <label style="display:flex; align-items:center; gap:.5rem; padding:.25rem .5rem;">
                            <input type="checkbox" value="${r.id}" ${selected.has(r.id) ? 'checked' : ''}>
                            <span style="font-weight:500; color: var(--text-primary);">${r.id}</span>
                            <span style="color: var(--text-secondary);">${r.title}</span>
                        </label>
                    `).join('');
                    return `
                        <div style="margin-bottom:.5rem;">
                            <div style="font-weight:600; color: var(--text-primary); margin:.5rem .25rem;">${domain.title}</div>
                            ${items}
                        </div>
                    `;
                }).join('');
                checklist.innerHTML = groups || '<p class="text-secondary" style="padding:.5rem;">No results</p>';
                // Attach change listeners
                checklist.querySelectorAll('input[type="checkbox"]').forEach(cb => {
                    cb.addEventListener('change', (e) => {
                        const id = e.target.value;
                        if (e.target.checked) selected.add(id); else selected.delete(id);
                    });
                });
            };

            renderChecklist('');
            if (searchInput) {
                searchInput.value = '';
                searchInput.oninput = (e) => renderChecklist(e.target.value);
            }

            // Wire buttons
            const cancelBtn = document.getElementById('cancelLinkRequirements');
            const saveBtn = document.getElementById('saveLinkRequirements');
            if (cancelBtn) cancelBtn.onclick = () => this.hideModal('linkRequirementsModal');
            if (saveBtn) saveBtn.onclick = () => {
                const p = this.projects.find(p => p.id === this.currentProjectId);
                if (p) {
                    p.requirements = Array.from(selected);
                    this.saveData();
                    this.updateProjectTabCounts();
                    this.renderProjectRequirements();
                }
                this.hideModal('linkRequirementsModal');
            };

            modal.style.display = 'block';
        }

        unlinkRequirementFromProject(reqId) {
            const p = this.projects.find(p => p.id === this.currentProjectId);
            if (!p || !Array.isArray(p.requirements)) return;
            p.requirements = p.requirements.filter(id => id !== reqId);
            this.saveData();
            this.updateProjectTabCounts();
            this.renderProjectRequirements();
        }

        exportData() {
            try {
                const exportData = {
                    version: '1.0',
                    timestamp: new Date().toISOString(),
                    data: {
                        projects: this.projects,
                        tasks: this.tasks,
                        risks: this.risks,
                        incidents: this.incidents,
                        compliance: this.compliance
                    }
                };

                const blob = new Blob([JSON.stringify(exportData, null, 2)], {
                    type: 'application/json'
                });

                const url = URL.createObjectURL(blob);
                const downloadLink = document.createElement('a');
                downloadLink.href = url;
                downloadLink.download = `pspf-explorer-backup-${new Date().toISOString().split('T')[0]}.json`;
                
                document.body.appendChild(downloadLink);
                downloadLink.click();
                document.body.removeChild(downloadLink);
                
                alert('Data exported successfully!');
                
            } catch (error) {
                console.error('Export failed:', error);
                alert('Export failed. Please try again.');
            }
        }

        importData(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = (e) => {
                try {
                    const importData = JSON.parse(e.target.result);
                    
                    if (!importData.data || !importData.version) {
                        throw new Error('Invalid backup file format');
                    }

                    if (!confirm('This will replace all current data with imported data. Continue?')) {
                        return;
                    }

                    this.projects = importData.data.projects || [];
                    this.tasks = importData.data.tasks || [];
                    this.risks = importData.data.risks || [];
                    this.incidents = importData.data.incidents || [];
                    this.compliance = importData.data.compliance || {};

                    this.saveData();
                    this.updateDataStats();
                    this.renderHome();

                    alert('Data imported successfully!');
                    
                } catch (error) {
                    console.error('Import failed:', error);
                    alert('Import failed. Please check the file format and try again.');
                }
            };

            reader.readAsText(file);
            event.target.value = '';
        }

        clearAllData() {
            if (!confirm('This will permanently delete ALL your data. This action cannot be undone!\n\nAre you sure?')) {
                return;
            }

            try {
                this.projects = [];
                this.tasks = [];
                this.risks = [];
                this.incidents = [];
                this.compliance = {};

                localStorage.removeItem('pspf_projects');
                localStorage.removeItem('pspf_tasks');
                localStorage.removeItem('pspf_risks');
                localStorage.removeItem('pspf_incidents');
                localStorage.removeItem('pspf_compliance');
                localStorage.removeItem('pspf_last_modified');

                this.updateDataStats();
                this.renderHome();

                alert('All data has been cleared successfully.');
                
            } catch (error) {
                console.error('Clear data failed:', error);
                alert('Failed to clear data. Please try again.');
            }
        }

        saveData() {
            localStorage.setItem('pspf_projects', JSON.stringify(this.projects));
            localStorage.setItem('pspf_tasks', JSON.stringify(this.tasks));
            localStorage.setItem('pspf_risks', JSON.stringify(this.risks));
            localStorage.setItem('pspf_incidents', JSON.stringify(this.incidents));
            localStorage.setItem('pspf_compliance', JSON.stringify(this.compliance));
            localStorage.setItem('pspf_last_modified', new Date().toISOString());
        }
    }

    // Initialize application when DOM is loaded
    document.addEventListener('DOMContentLoaded', () => {
        window.pspfExplorer = new PSPFExplorer();
    });
    </script>
</body>
</html>